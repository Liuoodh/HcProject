{
  "version": 3,
  "sources": [
    "node_modules/browser-pack/_prelude.js",
    "node_modules/events/events.js",
    "node_modules/process/browser.js",
    "src/controller/buffer-controller.js",
    "src/controller/flow-controller.js",
    "src/demux/exp-golomb.js",
    "src/demux/h264-demuxer.js",
    "src/errors.js",
    "src/event-handler.js",
    "src/events.js",
    "src/helper/aac.js",
    "src/index.js",
    "src/loader/crc.js",
    "src/loader/file-loader.js",
    "src/loader/websocket-loader.js",
    "src/remux/mp4-generator.js",
    "src/remux/mp4-remuxer.js",
    "src/utils/logger.js",
    "src/utils/polyfill.js",
    "src/utils/xhr-loader.js",
    "src/wfs.js"
  ],
  "names": [],
  "mappings": "AAAA;ACAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC9SA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAC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",
  "file": "generated.js",
  "sourceRoot": "",
  "sourcesContent": [
    "(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})",
    "// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\nfunction EventEmitter() {\n  this._events = this._events || {};\n  this._maxListeners = this._maxListeners || undefined;\n}\nmodule.exports = EventEmitter;\n\n// Backwards-compat with node 0.10.x\nEventEmitter.EventEmitter = EventEmitter;\n\nEventEmitter.prototype._events = undefined;\nEventEmitter.prototype._maxListeners = undefined;\n\n// By default EventEmitters will print a warning if more than 10 listeners are\n// added to it. This is a useful default which helps finding memory leaks.\nEventEmitter.defaultMaxListeners = 10;\n\n// Obviously not all Emitters should be limited to 10. This function allows\n// that to be increased. Set to zero for unlimited.\nEventEmitter.prototype.setMaxListeners = function(n) {\n  if (!isNumber(n) || n < 0 || isNaN(n))\n    throw TypeError('n must be a positive number');\n  this._maxListeners = n;\n  return this;\n};\n\nEventEmitter.prototype.emit = function(type) {\n  var er, handler, len, args, i, listeners;\n\n  if (!this._events)\n    this._events = {};\n\n  // If there is no 'error' event listener then throw.\n  if (type === 'error') {\n    if (!this._events.error ||\n        (isObject(this._events.error) && !this._events.error.length)) {\n      er = arguments[1];\n      if (er instanceof Error) {\n        throw er; // Unhandled 'error' event\n      } else {\n        // At least give some kind of context to the user\n        var err = new Error('Uncaught, unspecified \"error\" event. (' + er + ')');\n        err.context = er;\n        throw err;\n      }\n    }\n  }\n\n  handler = this._events[type];\n\n  if (isUndefined(handler))\n    return false;\n\n  if (isFunction(handler)) {\n    switch (arguments.length) {\n      // fast cases\n      case 1:\n        handler.call(this);\n        break;\n      case 2:\n        handler.call(this, arguments[1]);\n        break;\n      case 3:\n        handler.call(this, arguments[1], arguments[2]);\n        break;\n      // slower\n      default:\n        args = Array.prototype.slice.call(arguments, 1);\n        handler.apply(this, args);\n    }\n  } else if (isObject(handler)) {\n    args = Array.prototype.slice.call(arguments, 1);\n    listeners = handler.slice();\n    len = listeners.length;\n    for (i = 0; i < len; i++)\n      listeners[i].apply(this, args);\n  }\n\n  return true;\n};\n\nEventEmitter.prototype.addListener = function(type, listener) {\n  var m;\n\n  if (!isFunction(listener))\n    throw TypeError('listener must be a function');\n\n  if (!this._events)\n    this._events = {};\n\n  // To avoid recursion in the case that type === \"newListener\"! Before\n  // adding it to the listeners, first emit \"newListener\".\n  if (this._events.newListener)\n    this.emit('newListener', type,\n              isFunction(listener.listener) ?\n              listener.listener : listener);\n\n  if (!this._events[type])\n    // Optimize the case of one listener. Don't need the extra array object.\n    this._events[type] = listener;\n  else if (isObject(this._events[type]))\n    // If we've already got an array, just append.\n    this._events[type].push(listener);\n  else\n    // Adding the second element, need to change to array.\n    this._events[type] = [this._events[type], listener];\n\n  // Check for listener leak\n  if (isObject(this._events[type]) && !this._events[type].warned) {\n    if (!isUndefined(this._maxListeners)) {\n      m = this._maxListeners;\n    } else {\n      m = EventEmitter.defaultMaxListeners;\n    }\n\n    if (m && m > 0 && this._events[type].length > m) {\n      this._events[type].warned = true;\n      console.error('(node) warning: possible EventEmitter memory ' +\n                    'leak detected. %d listeners added. ' +\n                    'Use emitter.setMaxListeners() to increase limit.',\n                    this._events[type].length);\n      if (typeof console.trace === 'function') {\n        // not supported in IE 10\n        console.trace();\n      }\n    }\n  }\n\n  return this;\n};\n\nEventEmitter.prototype.on = EventEmitter.prototype.addListener;\n\nEventEmitter.prototype.once = function(type, listener) {\n  if (!isFunction(listener))\n    throw TypeError('listener must be a function');\n\n  var fired = false;\n\n  function g() {\n    this.removeListener(type, g);\n\n    if (!fired) {\n      fired = true;\n      listener.apply(this, arguments);\n    }\n  }\n\n  g.listener = listener;\n  this.on(type, g);\n\n  return this;\n};\n\n// emits a 'removeListener' event iff the listener was removed\nEventEmitter.prototype.removeListener = function(type, listener) {\n  var list, position, length, i;\n\n  if (!isFunction(listener))\n    throw TypeError('listener must be a function');\n\n  if (!this._events || !this._events[type])\n    return this;\n\n  list = this._events[type];\n  length = list.length;\n  position = -1;\n\n  if (list === listener ||\n      (isFunction(list.listener) && list.listener === listener)) {\n    delete this._events[type];\n    if (this._events.removeListener)\n      this.emit('removeListener', type, listener);\n\n  } else if (isObject(list)) {\n    for (i = length; i-- > 0;) {\n      if (list[i] === listener ||\n          (list[i].listener && list[i].listener === listener)) {\n        position = i;\n        break;\n      }\n    }\n\n    if (position < 0)\n      return this;\n\n    if (list.length === 1) {\n      list.length = 0;\n      delete this._events[type];\n    } else {\n      list.splice(position, 1);\n    }\n\n    if (this._events.removeListener)\n      this.emit('removeListener', type, listener);\n  }\n\n  return this;\n};\n\nEventEmitter.prototype.removeAllListeners = function(type) {\n  var key, listeners;\n\n  if (!this._events)\n    return this;\n\n  // not listening for removeListener, no need to emit\n  if (!this._events.removeListener) {\n    if (arguments.length === 0)\n      this._events = {};\n    else if (this._events[type])\n      delete this._events[type];\n    return this;\n  }\n\n  // emit removeListener for all listeners on all events\n  if (arguments.length === 0) {\n    for (key in this._events) {\n      if (key === 'removeListener') continue;\n      this.removeAllListeners(key);\n    }\n    this.removeAllListeners('removeListener');\n    this._events = {};\n    return this;\n  }\n\n  listeners = this._events[type];\n\n  if (isFunction(listeners)) {\n    this.removeListener(type, listeners);\n  } else if (listeners) {\n    // LIFO order\n    while (listeners.length)\n      this.removeListener(type, listeners[listeners.length - 1]);\n  }\n  delete this._events[type];\n\n  return this;\n};\n\nEventEmitter.prototype.listeners = function(type) {\n  var ret;\n  if (!this._events || !this._events[type])\n    ret = [];\n  else if (isFunction(this._events[type]))\n    ret = [this._events[type]];\n  else\n    ret = this._events[type].slice();\n  return ret;\n};\n\nEventEmitter.prototype.listenerCount = function(type) {\n  if (this._events) {\n    var evlistener = this._events[type];\n\n    if (isFunction(evlistener))\n      return 1;\n    else if (evlistener)\n      return evlistener.length;\n  }\n  return 0;\n};\n\nEventEmitter.listenerCount = function(emitter, type) {\n  return emitter.listenerCount(type);\n};\n\nfunction isFunction(arg) {\n  return typeof arg === 'function';\n}\n\nfunction isNumber(arg) {\n  return typeof arg === 'number';\n}\n\nfunction isObject(arg) {\n  return typeof arg === 'object' && arg !== null;\n}\n\nfunction isUndefined(arg) {\n  return arg === void 0;\n}\n",
    "// shim for using process in browser\nvar process = module.exports = {};\n\n// cached from whatever global is present so that test runners that stub it\n// don't break things.  But we need to wrap it in a try catch in case it is\n// wrapped in strict mode code which doesn't define any globals.  It's inside a\n// function because try/catches deoptimize in certain engines.\n\nvar cachedSetTimeout;\nvar cachedClearTimeout;\n\nfunction defaultSetTimout() {\n    throw new Error('setTimeout has not been defined');\n}\nfunction defaultClearTimeout () {\n    throw new Error('clearTimeout has not been defined');\n}\n(function () {\n    try {\n        if (typeof setTimeout === 'function') {\n            cachedSetTimeout = setTimeout;\n        } else {\n            cachedSetTimeout = defaultSetTimout;\n        }\n    } catch (e) {\n        cachedSetTimeout = defaultSetTimout;\n    }\n    try {\n        if (typeof clearTimeout === 'function') {\n            cachedClearTimeout = clearTimeout;\n        } else {\n            cachedClearTimeout = defaultClearTimeout;\n        }\n    } catch (e) {\n        cachedClearTimeout = defaultClearTimeout;\n    }\n} ())\nfunction runTimeout(fun) {\n    if (cachedSetTimeout === setTimeout) {\n        //normal enviroments in sane situations\n        return setTimeout(fun, 0);\n    }\n    // if setTimeout wasn't available but was latter defined\n    if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {\n        cachedSetTimeout = setTimeout;\n        return setTimeout(fun, 0);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedSetTimeout(fun, 0);\n    } catch(e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't trust the global object when called normally\n            return cachedSetTimeout.call(null, fun, 0);\n        } catch(e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error\n            return cachedSetTimeout.call(this, fun, 0);\n        }\n    }\n\n\n}\nfunction runClearTimeout(marker) {\n    if (cachedClearTimeout === clearTimeout) {\n        //normal enviroments in sane situations\n        return clearTimeout(marker);\n    }\n    // if clearTimeout wasn't available but was latter defined\n    if ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) && clearTimeout) {\n        cachedClearTimeout = clearTimeout;\n        return clearTimeout(marker);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedClearTimeout(marker);\n    } catch (e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't  trust the global object when called normally\n            return cachedClearTimeout.call(null, marker);\n        } catch (e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error.\n            // Some versions of I.E. have different rules for clearTimeout vs setTimeout\n            return cachedClearTimeout.call(this, marker);\n        }\n    }\n\n\n\n}\nvar queue = [];\nvar draining = false;\nvar currentQueue;\nvar queueIndex = -1;\n\nfunction cleanUpNextTick() {\n    if (!draining || !currentQueue) {\n        return;\n    }\n    draining = false;\n    if (currentQueue.length) {\n        queue = currentQueue.concat(queue);\n    } else {\n        queueIndex = -1;\n    }\n    if (queue.length) {\n        drainQueue();\n    }\n}\n\nfunction drainQueue() {\n    if (draining) {\n        return;\n    }\n    var timeout = runTimeout(cleanUpNextTick);\n    draining = true;\n\n    var len = queue.length;\n    while(len) {\n        currentQueue = queue;\n        queue = [];\n        while (++queueIndex < len) {\n            if (currentQueue) {\n                currentQueue[queueIndex].run();\n            }\n        }\n        queueIndex = -1;\n        len = queue.length;\n    }\n    currentQueue = null;\n    draining = false;\n    runClearTimeout(timeout);\n}\n\nprocess.nextTick = function (fun) {\n    var args = new Array(arguments.length - 1);\n    if (arguments.length > 1) {\n        for (var i = 1; i < arguments.length; i++) {\n            args[i - 1] = arguments[i];\n        }\n    }\n    queue.push(new Item(fun, args));\n    if (queue.length === 1 && !draining) {\n        runTimeout(drainQueue);\n    }\n};\n\n// v8 likes predictible objects\nfunction Item(fun, array) {\n    this.fun = fun;\n    this.array = array;\n}\nItem.prototype.run = function () {\n    this.fun.apply(null, this.array);\n};\nprocess.title = 'browser';\nprocess.browser = true;\nprocess.env = {};\nprocess.argv = [];\nprocess.version = ''; // empty string to avoid regexp issues\nprocess.versions = {};\n\nfunction noop() {}\n\nprocess.on = noop;\nprocess.addListener = noop;\nprocess.once = noop;\nprocess.off = noop;\nprocess.removeListener = noop;\nprocess.removeAllListeners = noop;\nprocess.emit = noop;\nprocess.prependListener = noop;\nprocess.prependOnceListener = noop;\n\nprocess.listeners = function (name) { return [] }\n\nprocess.binding = function (name) {\n    throw new Error('process.binding is not supported');\n};\n\nprocess.cwd = function () { return '/' };\nprocess.chdir = function (dir) {\n    throw new Error('process.chdir is not supported');\n};\nprocess.umask = function() { return 0; };\n",
    "/*\n * Buffer Controller\n*/\n\nimport Event from '../events';\nimport EventHandler from '../event-handler';\n \nclass BufferController extends EventHandler {\n\n  constructor(wfs) {\n    super(wfs,\n      Event.MEDIA_ATTACHING,\n      Event.BUFFER_APPENDING,\n      Event.BUFFER_RESET\n    );\n    \n    this.mediaSource = null;\n    this.media = null;\n    this.pendingTracks = {};\n    this.sourceBuffer = {};\n    this.segments = [];\n \n    this.appended = 0;\n    this._msDuration = null;\n\n    // Source Buffer listeners\n    this.onsbue = this.onSBUpdateEnd.bind(this);\n\n    this.browserType = 0;\n    if (navigator.userAgent.toLowerCase().indexOf('firefox') !== -1){\n      this.browserType = 1;\n    }\n    this.mediaType = 'H264Raw';\n\n    this.websocketName = undefined; \n    this.channelName = undefined;\n  }\n\n  destroy() {\n    EventHandler.prototype.destroy.call(this);\n  }\n \n  onMediaAttaching(data) {\n    let media = this.media = data.media;\n    this.mediaType = data.mediaType;\n    this.websocketName = data.websocketName;\n    this.channelName = data.channelName;\n    if (media) {\n      // setup the media source\n      var ms = this.mediaSource = new MediaSource();\n      //Media Source listeners\n      this.onmso = this.onMediaSourceOpen.bind(this);\n      this.onmse = this.onMediaSourceEnded.bind(this);\n      this.onmsc = this.onMediaSourceClose.bind(this);\n      ms.addEventListener('sourceopen', this.onmso);\n      ms.addEventListener('sourceended', this.onmse);\n      ms.addEventListener('sourceclose', this.onmsc);\n      // link video and media Source\n      media.src = URL.createObjectURL(ms);\n    }\n  }\n\n  onMediaDetaching() {\n \n  }\n   \n  onBufferAppending(data) { \n    if (!this.segments) {\n      this.segments = [ data ];\n    } else {\n      this.segments.push(data); \n    }\n    this.doAppending(); \n  }\n  \n  onMediaSourceClose() {\n    console.log('media source closed');\n  }\n\n  onMediaSourceEnded() {\n    console.log('media source ended');\n  }\n\n  onSBUpdateEnd(event) { \n    // Firefox\n    if (this.browserType === 1){\n      this.mediaSource.endOfStream();\n      this.media.play();  \n    }\n\n    console.log(\"currentTime: \" + this.media.currentTime);\n    var buffered = this.sourceBuffer['video'].buffered;\n    var played   = this.media.played;\n    for(var j = 0; j < played.length; j++){\n\tconsole.log(\"played start: \" + played.start(j) );\n\tconsole.log(\"played end: \" + played.end(j) );\n    }\n    console.log(\"readystate: \" + this.media.readyState);\n    for(var i=0; i< buffered.length; i++){\n\tconsole.log(\"start: \" + buffered.start(i) );\n\tconsole.log(\"end: \" + buffered.end(i));\n    \t//this.media.currentTime = buffered.end(i); \n    }\n\n    this.appending = false;\n    this.doAppending();\n    this.updateMediaElementDuration();\n  }\n \n  updateMediaElementDuration() {\n  \n  }\n\n  onMediaSourceOpen() { \n    let mediaSource = this.mediaSource;\n    if (mediaSource) {\n      // once received, don't listen anymore to sourceopen event\n      mediaSource.removeEventListener('sourceopen', this.onmso);\n    }\n\n    if (this.mediaType === 'FMp4'){ \n      this.checkPendingTracks();\n    }\n\n    this.wfs.trigger(Event.MEDIA_ATTACHED, {media:this.media, channelName:this.channelName, mediaType: this.mediaType, websocketName:this.websocketName});\n  }\n\n  checkPendingTracks() {  \n    this.createSourceBuffers({ tracks : 'video' , mimeType:'' } );\n    this.pendingTracks = {};  \n  }\n\n  onBufferReset(data) { \n    if (this.mediaType === 'H264Raw'){ \n      this.createSourceBuffers({ tracks : 'video' , mimeType: data.mimeType } );\n    }\n  }\n \n  createSourceBuffers(tracks) {\n    var sourceBuffer = this.sourceBuffer,mediaSource = this.mediaSource;\n    let mimeType;\n    if (tracks.mimeType === ''){\n      mimeType = 'video/mp4;codecs=avc1.420028'; // avc1.42c01f avc1.42801e avc1.640028 avc1.420028\n    }else{\n      mimeType = 'video/mp4;codecs=' + tracks.mimeType;\n    }\n \n    try {\n      let sb = sourceBuffer['video'] = mediaSource.addSourceBuffer(mimeType);\n      sb.addEventListener('updateend', this.onsbue);\n      track.buffer = sb;\n    } catch(err) {\n\n    }\n    this.wfs.trigger(Event.BUFFER_CREATED, { tracks : tracks } );\n    this.media.play();    \n  }\n\n  doAppending() {\n   \n    var wfs = this.wfs, sourceBuffer = this.sourceBuffer, segments = this.segments;\n    if (Object.keys(sourceBuffer).length) {\n       \n      if (this.media.error) {\n        this.segments = [];\n        console.log('trying to append although a media error occured, flush segment and abort');\n        return;\n      }\n      if (this.appending) { \n        return;\n      }\n         \n      if (segments && segments.length) { \n        var segment = segments.shift();\n\t//console.log(\"segments len: \" + segments.length + \" segment len: \" + segment.data.length);\n        try {\n          if(sourceBuffer[segment.type]) { \n            this.parent = segment.parent;\n            sourceBuffer[segment.type].appendBuffer(segment.data);\n            this.appendError = 0;\n            this.appended++;\n            this.appending = true;\n          } else {\n  \n          }\n        } catch(err) {\n          // in case any error occured while appending, put back segment in segments table \n          segments.unshift(segment);\n          var event = {type: ErrorTypes.MEDIA_ERROR};\n          if(err.code !== 22) {\n            if (this.appendError) {\n              this.appendError++;\n            } else {\n              this.appendError = 1;\n            }\n            event.details = ErrorDetails.BUFFER_APPEND_ERROR;\n            event.frag = this.fragCurrent;   \n            if (this.appendError > wfs.config.appendErrorMaxRetry) { \n              segments = [];\n              event.fatal = true;    \n              return;\n            } else {\n              event.fatal = false; \n            }\n          } else { \n            this.segments = [];\n            event.details = ErrorDetails.BUFFER_FULL_ERROR; \n            return;\n          } \n        }\n        \n      }\n    }\n  }\n \n}\n\nexport default BufferController;\n",
    "/*\n * Flow Controller\n*/\n \nimport Event from '../events';\nimport EventHandler from '../event-handler'; \n\nclass FlowController extends EventHandler {\n\n  constructor(wfs) {\n    super(wfs,\n      Event.MEDIA_ATTACHED,\n      Event.BUFFER_CREATED,\n      Event.FILE_PARSING_DATA,\n      Event.FILE_HEAD_LOADED,\n      Event.FILE_DATA_LOADED,\n      Event.WEBSOCKET_ATTACHED,\n      Event.FRAG_PARSING_DATA,\n      Event.FRAG_PARSING_INIT_SEGMENT);\n    \n    this.fileStart = 0;\n    this.fileEnd = 0;\n    this.pendingAppending = 0;\n    this.mediaType = undefined; \n    channelName:this.channelName;\n  }\n\n  destroy() {\n     EventHandler.prototype.destroy.call(this);\n  }  \n\n  onMediaAttached(data) {      \n    if (data.websocketName != undefined){\n      //var client = new WebSocket( 'ws://' + window.location.host + '/' +  data.websocketName );\n      var uri = 'ws://' + '192.168.2.51:10010';\n      var protocol = 'binary';\n      var client = new WebSocket(uri,protocol);\n      this.wfs.attachWebsocket(client,data.channelName);\n    }else{\n       console.log('websocketName ERROE!!!');\n    }\n\n  }\n  \n  onBufferCreated(data) {\n    this.mediaType = data.mediaType; \n  }\n\n  onFileHeadLoaded(data) { \n  }\n\n  onFileDataLoaded(data) { \n  }\n\n  onFileParsingData(data) {\n  }\n \n  onWebsocketAttached(data) {\n    this.wfs.trigger(Event.BUFFER_APPENDING, {type: 'video', data: data.payload, parent : 'main'}); \n  }\n  \n  onFragParsingInitSegment(data) {\n  \t var tracks = data.tracks, trackName, track;\n \n      track = tracks.video;\n      if(track) { \n        track.id = data.id;\n      }\n \n      for (trackName in tracks) {\n        track = tracks[trackName];\n        var initSegment = track.initSegment;\n        if (initSegment) {\n          this.pendingAppending++;\n          this.wfs.trigger(Event.BUFFER_APPENDING, {type: trackName, data: initSegment, parent : 'main'});\n        }\n      }\n \n  }\n\n  onFragParsingData(data) {\n \n      if(data.type === 'video') {\n     \n      }\n       \n      [data.data1, data.data2].forEach(buffer => {\n        if (buffer) {\n          this.pendingAppending++;\n          this.wfs.trigger(Event.BUFFER_APPENDING, {type: data.type, data: buffer, parent : 'main'}); \n        }\n      });\n \n  }\n\n}\nexport default FlowController;  \n",
    "/**\n * Parser for exponential Golomb codes, a variable-bitwidth number encoding scheme used by h264.\n*/\n\nimport {logger} from '../utils/logger';\n\nclass ExpGolomb {\n\n  constructor(data) {\n    this.data = data;\n    // the number of bytes left to examine in this.data\n    this.bytesAvailable = this.data.byteLength;\n    // the current word being examined\n    this.word = 0; // :uint\n    // the number of bits left to examine in the current word\n    this.bitsAvailable = 0; // :uint\n  }\n\n  // ():void\n  loadWord() {\n    var\n      position = this.data.byteLength - this.bytesAvailable,\n      workingBytes = new Uint8Array(4),\n      availableBytes = Math.min(4, this.bytesAvailable);\n    if (availableBytes === 0) {\n      throw new Error('no bytes available');\n    }\n    workingBytes.set(this.data.subarray(position, position + availableBytes));\n    this.word = new DataView(workingBytes.buffer).getUint32(0);\n    // track the amount of this.data that has been processed\n    this.bitsAvailable = availableBytes * 8;\n    this.bytesAvailable -= availableBytes;\n  }\n\n  // (count:int):void\n  skipBits(count) {\n    var skipBytes; // :int\n    if (this.bitsAvailable > count) {\n      this.word <<= count;\n      this.bitsAvailable -= count;\n    } else {\n      count -= this.bitsAvailable;\n      skipBytes = count >> 3;\n      count -= (skipBytes >> 3);\n      this.bytesAvailable -= skipBytes;\n      this.loadWord();\n      this.word <<= count;\n      this.bitsAvailable -= count;\n    }\n  }\n\n  // (size:int):uint\n  readBits(size) {\n    var\n      bits = Math.min(this.bitsAvailable, size), // :uint\n      valu = this.word >>> (32 - bits); // :uint\n    if (size > 32) {\n      logger.error('Cannot read more than 32 bits at a time');\n    }\n    this.bitsAvailable -= bits;\n    if (this.bitsAvailable > 0) {\n      this.word <<= bits;\n    } else if (this.bytesAvailable > 0) {\n      this.loadWord();\n    }\n    bits = size - bits;\n    if (bits > 0) {\n      return valu << bits | this.readBits(bits);\n    } else {\n      return valu;\n    }\n  }\n\n  // ():uint\n  skipLZ() {\n    var leadingZeroCount; // :uint\n    for (leadingZeroCount = 0; leadingZeroCount < this.bitsAvailable; ++leadingZeroCount) {\n      if (0 !== (this.word & (0x80000000 >>> leadingZeroCount))) {\n        // the first bit of working word is 1\n        this.word <<= leadingZeroCount;\n        this.bitsAvailable -= leadingZeroCount;\n        return leadingZeroCount;\n      }\n    }\n    // we exhausted word and still have not found a 1\n    this.loadWord();\n    return leadingZeroCount + this.skipLZ();\n  }\n\n  // ():void\n  skipUEG() {\n    this.skipBits(1 + this.skipLZ());\n  }\n\n  // ():void\n  skipEG() {\n    this.skipBits(1 + this.skipLZ());\n  }\n\n  // ():uint\n  readUEG() {\n    var clz = this.skipLZ(); // :uint\n    return this.readBits(clz + 1) - 1;\n  }\n\n  // ():int\n  readEG() {\n    var valu = this.readUEG(); // :int\n    if (0x01 & valu) {\n      // the number is odd if the low order bit is set\n      return (1 + valu) >>> 1; // add 1 to make it even, and divide by 2\n    } else {\n      return -1 * (valu >>> 1); // divide by two then make it negative\n    }\n  }\n\n  // Some convenience functions\n  // :Boolean\n  readBoolean() {\n    return 1 === this.readBits(1);\n  }\n\n  // ():int\n  readUByte() {\n    return this.readBits(8);\n  }\n\n  // ():int\n  readUShort() {\n    return this.readBits(16);\n  }\n    // ():int\n  readUInt() {\n    return this.readBits(32);\n  }\n\n  /**\n   * Advance the ExpGolomb decoder past a scaling list. The scaling\n   * list is optionally transmitted as part of a sequence parameter\n   * set and is not relevant to transmuxing.\n   * @param count {number} the number of entries in this scaling list\n   * @see Recommendation ITU-T H.264, Section 7.3.2.1.1.1\n   */\n  skipScalingList(count) {\n    var\n      lastScale = 8,\n      nextScale = 8,\n      j,\n      deltaScale;\n    for (j = 0; j < count; j++) {\n      if (nextScale !== 0) {\n        deltaScale = this.readEG();\n        nextScale = (lastScale + deltaScale + 256) % 256;\n      }\n      lastScale = (nextScale === 0) ? lastScale : nextScale;\n    }\n  }\n\n  /**\n   * Read a sequence parameter set and return some interesting video\n   * properties. A sequence parameter set is the H264 metadata that\n   * describes the properties of upcoming video frames.\n   * @param data {Uint8Array} the bytes of a sequence parameter set\n   * @return {object} an object with configuration parsed from the\n   * sequence parameter set, including the dimensions of the\n   * associated video frames.\n   */\n  readSPS() {\n    var\n      frameCropLeftOffset = 0,\n      frameCropRightOffset = 0,\n      frameCropTopOffset = 0,\n      frameCropBottomOffset = 0,\n      sarScale = 1,\n      profileIdc,profileCompat,levelIdc,\n      numRefFramesInPicOrderCntCycle, picWidthInMbsMinus1,\n      picHeightInMapUnitsMinus1,\n      frameMbsOnlyFlag,\n      scalingListCount,\n      i;\n    this.readUByte();\n    profileIdc = this.readUByte(); // profile_idc\n    profileCompat = this.readBits(5); // constraint_set[0-4]_flag, u(5)\n    this.skipBits(3); // reserved_zero_3bits u(3),\n    levelIdc = this.readUByte(); //level_idc u(8)\n    this.skipUEG(); // seq_parameter_set_id\n    // some profiles have more optional data we don't need\n    if (profileIdc === 100 ||\n        profileIdc === 110 ||\n        profileIdc === 122 ||\n        profileIdc === 244 ||\n        profileIdc === 44  ||\n        profileIdc === 83  ||\n        profileIdc === 86  ||\n        profileIdc === 118 ||\n        profileIdc === 128) {\n      var chromaFormatIdc = this.readUEG();\n      if (chromaFormatIdc === 3) {\n        this.skipBits(1); // separate_colour_plane_flag\n      }\n      this.skipUEG(); // bit_depth_luma_minus8\n      this.skipUEG(); // bit_depth_chroma_minus8\n      this.skipBits(1); // qpprime_y_zero_transform_bypass_flag\n      if (this.readBoolean()) { // seq_scaling_matrix_present_flag\n        scalingListCount = (chromaFormatIdc !== 3) ? 8 : 12;\n        for (i = 0; i < scalingListCount; i++) {\n          if (this.readBoolean()) { // seq_scaling_list_present_flag[ i ]\n            if (i < 6) {\n              this.skipScalingList(16);\n            } else {\n              this.skipScalingList(64);\n            }\n          }\n        }\n      }\n    }\n    this.skipUEG(); // log2_max_frame_num_minus4\n    var picOrderCntType = this.readUEG();\n    if (picOrderCntType === 0) {\n      this.readUEG(); //log2_max_pic_order_cnt_lsb_minus4\n    } else if (picOrderCntType === 1) {\n      this.skipBits(1); // delta_pic_order_always_zero_flag\n      this.skipEG(); // offset_for_non_ref_pic\n      this.skipEG(); // offset_for_top_to_bottom_field\n      numRefFramesInPicOrderCntCycle = this.readUEG();\n      for(i = 0; i < numRefFramesInPicOrderCntCycle; i++) {\n        this.skipEG(); // offset_for_ref_frame[ i ]\n      }\n    }\n    this.skipUEG(); // max_num_ref_frames\n    this.skipBits(1); // gaps_in_frame_num_value_allowed_flag\n    picWidthInMbsMinus1 = this.readUEG();\n    picHeightInMapUnitsMinus1 = this.readUEG();\n    frameMbsOnlyFlag = this.readBits(1);\n    if (frameMbsOnlyFlag === 0) {\n      this.skipBits(1); // mb_adaptive_frame_field_flag\n    }\n    this.skipBits(1); // direct_8x8_inference_flag\n    if (this.readBoolean()) { // frame_cropping_flag\n      frameCropLeftOffset = this.readUEG();\n      frameCropRightOffset = this.readUEG();\n      frameCropTopOffset = this.readUEG();\n      frameCropBottomOffset = this.readUEG();\n    }\n    if (this.readBoolean()) {\n      // vui_parameters_present_flag\n      if (this.readBoolean()) {\n        // aspect_ratio_info_present_flag\n        let sarRatio;\n        const aspectRatioIdc = this.readUByte();\n        switch (aspectRatioIdc) {\n          case 1: sarRatio = [1,1]; break;\n          case 2: sarRatio = [12,11]; break;\n          case 3: sarRatio = [10,11]; break;\n          case 4: sarRatio = [16,11]; break;\n          case 5: sarRatio = [40,33]; break;\n          case 6: sarRatio = [24,11]; break;\n          case 7: sarRatio = [20,11]; break;\n          case 8: sarRatio = [32,11]; break;\n          case 9: sarRatio = [80,33]; break;\n          case 10: sarRatio = [18,11]; break;\n          case 11: sarRatio = [15,11]; break;\n          case 12: sarRatio = [64,33]; break;\n          case 13: sarRatio = [160,99]; break;\n          case 14: sarRatio = [4,3]; break;\n          case 15: sarRatio = [3,2]; break;\n          case 16: sarRatio = [2,1]; break;\n          case 255: {\n            sarRatio = [this.readUByte() << 8 | this.readUByte(), this.readUByte() << 8 | this.readUByte()];\n            break;\n          }\n        }\n        if (sarRatio) {\n          sarScale = sarRatio[0] / sarRatio[1];\n        }\n      }\n    }\n    return {\n      width: Math.ceil((((picWidthInMbsMinus1 + 1) * 16) - frameCropLeftOffset * 2 - frameCropRightOffset * 2) * sarScale),\n      height: ((2 - frameMbsOnlyFlag) * (picHeightInMapUnitsMinus1 + 1) * 16) - ((frameMbsOnlyFlag? 2 : 4) * (frameCropTopOffset + frameCropBottomOffset))\n    };\n  }\n\n  readSliceType() {\n    // skip NALu type\n    this.readUByte();\n    // discard first_mb_in_slice\n    this.readUEG();\n    // return slice_type\n    return this.readUEG();\n  }\n}\n\nexport default ExpGolomb;\n",
    "/**\n\n*/\nimport {ErrorTypes, ErrorDetails} from '../errors';\nimport Event from '../events';\nimport ExpGolomb from './exp-golomb';\nimport EventHandler from '../event-handler';\nimport MP4Remuxer from '../remux/mp4-remuxer';\n\nclass h264Demuxer extends EventHandler {\n  \n  constructor(wfs, config=null) {\n    super(wfs, \n      Event.H264_DATA_PARSING);\n\n    this.config = this.wfs.config || config;\n    this.wfs = wfs;\n    this.id = 'main';\n    var typeSupported = {\n      mp4 : MediaSource.isTypeSupported('video/mp4')//,\n     // mp2t : wfs.config.enableMP2TPassThrough && MediaSource.isTypeSupported('video/mp2t')\n    };\n \n    this.remuxer = new MP4Remuxer(this.wfs, this.id , this.config);   \n    this.contiguous = true; \n    this.timeOffset = 1;\n    this.sn = 0;\n    this.TIMESCALE = 90000; \n    this.timestamp = 0;\n    this.scaleFactor = this.TIMESCALE /1000;\n    this.H264_TIMEBASE = 3000;\n    this._avcTrack = {container : 'video/mp4', type: 'video', id :1, sequenceNumber: 0,\n    //this._avcTrack = {container : 'video/mp4', type: 'video', id :1, sequenceNumber: 0,\n     samples : [], len : 0, nbNalu : 0, dropped : 0, count : 0 };\n    this.browserType = 0;\n    if (navigator.userAgent.toLowerCase().indexOf('firefox') !== -1){\n      this.browserType = 1;\n    }\n  }\n\n  destroy() {\n    EventHandler.prototype.destroy.call(this);\n  }\n \n  getTimestampM() {\n    this.timestamp += this.H264_TIMEBASE;\n    return  this.timestamp;\n  }\n\n  onH264DataParsing(event){ \n    this._parseAVCTrack( event.data); \n    if (this.browserType === 1){ // Firefox\n      this.remuxer.pushVideo(0, this.sn, this._avcTrack, this.timeOffset, this.contiguous);\n      this.sn += 1;\n    }else{\n        this.remuxer.pushVideo(0, this.sn, this._avcTrack, this.timeOffset, this.contiguous);\n        this.sn += 1;\n    } \n  } \n\n  _parseAVCTrack(array) {\n    var track = this._avcTrack,\n      samples = track.samples,\n      units = this._parseAVCNALu(array),\n      units2 = [],\n      debug = false,\n      key = false,\n      length = 0,\n      expGolombDecoder,\n      avcSample,\n      push,\n      i;    \n    var debugString = '';\n    var pushAccesUnit = function() {\n      if (units2.length) { \n        if (!this.config.forceKeyFrameOnDiscontinuity ||\n            key === true ||\n            (track.sps && (samples.length || this.contiguous))) { \n          var tss = this.getTimestampM();\n          avcSample = {units: { units : units2, length : length}, pts: tss, dts: tss, key: key};\n          samples.push(avcSample);\n          track.len += length;\n          track.nbNalu += units2.length;\n        } else { \n          track.dropped++;\n        }\n        units2 = [];\n        length = 0;\n      }\n    }.bind(this);\n\n    units.forEach(unit => {\n      switch(unit.type) {\n        //NDR\n         case 1:\n           push = true;\n           if(debug) {\n            debugString += 'NDR ';\n           }\n           break;\n        //IDR\n        case 5:\n          push = true;\n          if(debug) {\n            debugString += 'IDR ';\n          } \n          key = true;\n          break;\n        //SEI\n        case 6:\n          unit.data = this.discardEPB(unit.data);\n          expGolombDecoder = new ExpGolomb(unit.data);\n          // skip frameType\n          expGolombDecoder.readUByte();\n          break;\n        //SPS\n        case 7:\n          push = false;\n          if(debug) {\n            debugString += 'SPS ';\n          }\n          if(!track.sps) {\n            expGolombDecoder = new ExpGolomb(unit.data);\n            var config = expGolombDecoder.readSPS();\n            track.width = config.width;\n            track.height = config.height;\n            track.sps = [unit.data];\n            track.duration = 0; \n            var codecarray = unit.data.subarray(1, 4);\n            var codecstring = 'avc1.';\n            for (i = 0; i < 3; i++) {\n              var h = codecarray[i].toString(16);\n              if (h.length < 2) {\n                h = '0' + h;\n              }\n              codecstring += h;\n            }\n            track.codec = codecstring;         \n            this.wfs.trigger(Event.BUFFER_RESET, {  mimeType:  track.codec } ); \n            push = true;\n          }\n          break;\n        //PPS\n        case 8:\n          push = false;\n          if(debug) {\n            debugString += 'PPS ';\n          }\n          if (!track.pps) {\n            track.pps = [unit.data];\n             push = true;\n          }\n          break; \n        case 9:\n          push = false;\n          if(debug) {\n            debugString += 'AUD ';\n          }\n          pushAccesUnit();\n          break;      \n        default:\n          push = false;\n          debugString += 'unknown NAL ' + unit.type + ' ';\n          break;\n      }\n    \n      if(push) {\n        units2.push(unit);\n        length+=unit.data.byteLength; \n      }\n    \n    });\n    \n    if(debug || debugString.length) {\n      logger.log(debugString);\n    }\n    \n    pushAccesUnit();\n   \n  }\n  \n  _parseAVCNALu(array) {\n    var i = 0, len = array.byteLength, value, overflow, state = 0; //state = this.avcNaluState;\n    var units = [], unit, unitType, lastUnitStart, lastUnitType; \n    while (i < len) {\n      value = array[i++];\n      // finding 3 or 4-byte start codes (00 00 01 OR 00 00 00 01)\n      switch (state) {\n        case 0:\n          if (value === 0) {\n            state = 1;\n          }\n          break;\n        case 1:\n          if( value === 0) {\n            state = 2;\n          } else {\n            state = 0;\n          }\n          break;\n        case 2:\n        case 3:\n          if( value === 0) {\n            state = 3;\n          } else if (value === 1 && i < len) {\n            unitType = array[i] & 0x1f;\n            if (lastUnitStart) {\n              unit = {data: array.subarray(lastUnitStart, i - state - 1), type: lastUnitType}; \n              units.push(unit); \n            } else { \n            }\n            lastUnitStart = i;\n            lastUnitType = unitType;\n            state = 0;\n          } else {\n            state = 0;\n          }\n          break;\n        default:\n          break;\n      }\n    }\n\n    if (lastUnitStart) { \n      unit = {data: array.subarray(lastUnitStart, len), type: lastUnitType, state : state};\n      units.push(unit); \n    }\n\n    return units;\n  }\n\n  /**\n   * remove Emulation Prevention bytes from a RBSP\n   */\n  discardEPB(data) {\n    var length = data.byteLength,\n        EPBPositions = [],\n        i = 1,\n        newLength, newData;\n    // Find all `Emulation Prevention Bytes`\n    while (i < length - 2) {\n      if (data[i] === 0 &&\n          data[i + 1] === 0 &&\n          data[i + 2] === 0x03) {\n        EPBPositions.push(i + 2);\n        i += 2;\n      } else {\n        i++;\n      }\n    }\n    // If no Emulation Prevention Bytes were found just return the original\n    // array\n    if (EPBPositions.length === 0) {\n      return data;\n    }\n    // Create a new array to hold the NAL unit data\n    newLength = length - EPBPositions.length;\n    newData = new Uint8Array(newLength);\n    var sourceIndex = 0;\n\n    for (i = 0; i < newLength; sourceIndex++, i++) {\n      if (sourceIndex === EPBPositions[0]) {\n        // Skip this byte\n        sourceIndex++;\n        // Remove this position index\n        EPBPositions.shift();\n      }\n      newData[i] = data[sourceIndex];\n    }\n    return newData;\n  }\n\n \n}\n\nexport default h264Demuxer;\n\n",
    "export const ErrorTypes = {\n  // Identifier for a network error (loading error / timeout ...)\n  NETWORK_ERROR: 'networkError',\n  // Identifier for a media Error (video/parsing/mediasource error)\n  MEDIA_ERROR: 'mediaError',\n  // Identifier for all other errors\n  OTHER_ERROR: 'otherError'\n};\n\nexport const ErrorDetails = {\n  // Identifier for a manifest load error - data: { url : faulty URL, response : { code: error code, text: error text }}\n  MANIFEST_LOAD_ERROR: 'manifestLoadError',\n  // Identifier for a manifest load timeout - data: { url : faulty URL, response : { code: error code, text: error text }}\n  MANIFEST_LOAD_TIMEOUT: 'manifestLoadTimeOut',\n  // Identifier for a manifest parsing error - data: { url : faulty URL, reason : error reason}\n  MANIFEST_PARSING_ERROR: 'manifestParsingError',\n  // Identifier for a manifest with only incompatible codecs error - data: { url : faulty URL, reason : error reason}\n  MANIFEST_INCOMPATIBLE_CODECS_ERROR: 'manifestIncompatibleCodecsError',\n  // Identifier for a level load error - data: { url : faulty URL, response : { code: error code, text: error text }}\n  LEVEL_LOAD_ERROR: 'levelLoadError',\n  // Identifier for a level load timeout - data: { url : faulty URL, response : { code: error code, text: error text }}\n  LEVEL_LOAD_TIMEOUT: 'levelLoadTimeOut',\n  // Identifier for a level switch error - data: { level : faulty level Id, event : error description}\n  LEVEL_SWITCH_ERROR: 'levelSwitchError',\n  // Identifier for an audio track load error - data: { url : faulty URL, response : { code: error code, text: error text }}\n  AUDIO_TRACK_LOAD_ERROR: 'audioTrackLoadError',\n  // Identifier for an audio track load timeout - data: { url : faulty URL, response : { code: error code, text: error text }}\n  AUDIO_TRACK_LOAD_TIMEOUT: 'audioTrackLoadTimeOut',\n  // Identifier for fragment load error - data: { frag : fragment object, response : { code: error code, text: error text }}\n  FRAG_LOAD_ERROR: 'fragLoadError',\n  // Identifier for fragment loop loading error - data: { frag : fragment object}\n  FRAG_LOOP_LOADING_ERROR: 'fragLoopLoadingError',\n  // Identifier for fragment load timeout error - data: { frag : fragment object}\n  FRAG_LOAD_TIMEOUT: 'fragLoadTimeOut',\n  // Identifier for a fragment decryption error event - data: parsing error description\n  FRAG_DECRYPT_ERROR: 'fragDecryptError',\n  // Identifier for a fragment parsing error event - data: parsing error description\n  FRAG_PARSING_ERROR: 'fragParsingError',\n  // Identifier for decrypt key load error - data: { frag : fragment object, response : { code: error code, text: error text }}\n  KEY_LOAD_ERROR: 'keyLoadError',\n  // Identifier for decrypt key load timeout error - data: { frag : fragment object}\n  KEY_LOAD_TIMEOUT: 'keyLoadTimeOut',\n  // Triggered when an exception occurs while adding a sourceBuffer to MediaSource - data : {  err : exception , mimeType : mimeType }\n  BUFFER_ADD_CODEC_ERROR: 'bufferAddCodecError',\n  // Identifier for a buffer append error - data: append error description\n  BUFFER_APPEND_ERROR: 'bufferAppendError',\n  // Identifier for a buffer appending error event - data: appending error description\n  BUFFER_APPENDING_ERROR: 'bufferAppendingError',\n  // Identifier for a buffer stalled error event\n  BUFFER_STALLED_ERROR: 'bufferStalledError',\n  // Identifier for a buffer full event\n  BUFFER_FULL_ERROR: 'bufferFullError',\n  // Identifier for a buffer seek over hole event\n  BUFFER_SEEK_OVER_HOLE: 'bufferSeekOverHole',\n  // Identifier for an internal exception happening inside hls.js while handling an event\n  INTERNAL_EXCEPTION: 'internalException'\n};\n",
    "/*\n*\n* All objects in the event handling chain should inherit from this class\n*\n*/ \nimport Event from './events';\n\nclass EventHandler {\n\n  constructor(wfs, ...events) {\n    this.wfs = wfs;\n    this.onEvent = this.onEvent.bind(this);\n    this.handledEvents = events;\n    this.useGenericHandler = true;\n\n    this.registerListeners();\n  }\n\n  destroy() {\n    this.unregisterListeners();\n  }\n\n  isEventHandler() {\n    return typeof this.handledEvents === 'object' && this.handledEvents.length && typeof this.onEvent === 'function';\n  }\n\n  registerListeners() {\n    if (this.isEventHandler()) {\n      this.handledEvents.forEach(function(event) {\n        if (event === 'wfsEventGeneric') {\n          //throw new Error('Forbidden event name: ' + event);\n        }\n        this.wfs.on(event, this.onEvent);\n      }.bind(this));\n    }\n  }\n\n  unregisterListeners() {\n    if (this.isEventHandler()) {\n      this.handledEvents.forEach(function(event) {\n        this.wfs.off(event, this.onEvent);\n      }.bind(this));\n    }\n  }\n\n  /**\n   * arguments: event (string), data (any)\n   */\n  onEvent(event, data) {\n    this.onEventGeneric(event, data);\n  }\n\n  onEventGeneric(event, data) {\n    var eventToFunction = function(event, data) {\n      var funcName = 'on' + event.replace('wfs', '');\n      if (typeof this[funcName] !== 'function') {\n        //throw new Error(`Event ${event} has no generic handler in this ${this.constructor.name} class (tried ${funcName})`);\n      }\n      return this[funcName].bind(this, data);\n    };\n    try {\n      eventToFunction.call(this, event, data).call();\n    } catch (err) {\n      console.log(`internal error happened while processing ${event}:${err.message}`);\n   //   this.hls.trigger(Event.ERROR, {type: ErrorTypes.OTHER_ERROR, details: ErrorDetails.INTERNAL_EXCEPTION, fatal: false, event : event, err : err});\n    }\n  }\n}\n\nexport default EventHandler;\n",
    "module.exports = {\n \n  MEDIA_ATTACHING: 'wfsMediaAttaching',  \n \n  MEDIA_ATTACHED: 'wfsMediaAttached',\n \n  FRAG_LOADING: 'wfsFragLoading',\n\n  BUFFER_CREATED: 'wfsBufferCreated', \n\n  BUFFER_APPENDING: 'wfsBufferAppending',\n\n  BUFFER_RESET: 'wfsBufferReset', \n\n  FRAG_PARSING_DATA: 'wfsFragParsingData',\n \n  FRAG_PARSING_INIT_SEGMENT: 'wfsFragParsingInitSegment',\n//------------------------------------------\n  H264_DATA_PARSING: 'wfsH264DataParsing',\n//------------------------------------------\n  WEBSOCKET_ATTACHED: 'wfsWebsocketAttached',\n\n  WEBSOCKET_ATTACHING: 'wfsWebsocketAttaching',\n\n  WEBSOCKET_DATA_UPLOADING: 'wfsWebsocketDataUploading',\n\n  WEBSOCKET_MESSAGE_SENDING: 'wfsWebsocketMessageSending',   \n//------------------------------------------\n  FILE_HEAD_LOADING: 'wfsFileHeadLoading',\n\n  FILE_HEAD_LOADED: 'wfsFileHeadLoaded',\n\n  FILE_DATA_LOADING: 'wfsFileDataLoading',\n\n  FILE_DATA_LOADED: 'wfsFileDataLoaded',\n\n  FILE_PARSING_DATA: 'wfsFileParsingData'\n//------------------------------------------\n\n};\n",
    "/**\n *  AAC helper\n */\n\nclass AAC {\n  static getSilentFrame(channelCount) {\n    if (channelCount === 1) {\n      return new Uint8Array([0x00, 0xc8, 0x00, 0x80, 0x23, 0x80]);\n    } else if (channelCount === 2) {\n      return new Uint8Array([0x21, 0x00, 0x49, 0x90, 0x02, 0x19, 0x00, 0x23, 0x80]);\n    } else if (channelCount === 3) {\n      return new Uint8Array([0x00, 0xc8, 0x00, 0x80, 0x20, 0x84, 0x01, 0x26, 0x40, 0x08, 0x64, 0x00, 0x8e]);\n    } else if (channelCount === 4) {\n      return new Uint8Array([0x00, 0xc8, 0x00, 0x80, 0x20, 0x84, 0x01, 0x26, 0x40, 0x08, 0x64, 0x00, 0x80, 0x2c, 0x80, 0x08, 0x02, 0x38]);\n    } else if (channelCount === 5) {\n      return new Uint8Array([0x00, 0xc8, 0x00, 0x80, 0x20, 0x84, 0x01, 0x26, 0x40, 0x08, 0x64, 0x00, 0x82, 0x30, 0x04, 0x99, 0x00, 0x21, 0x90, 0x02, 0x38]);\n    } else if (channelCount === 6) {\n      return new Uint8Array([0x00, 0xc8, 0x00, 0x80, 0x20, 0x84, 0x01, 0x26, 0x40, 0x08, 0x64, 0x00, 0x82, 0x30, 0x04, 0x99, 0x00, 0x21, 0x90, 0x02, 0x00, 0xb2, 0x00, 0x20, 0x08, 0xe0]);\n    }\n    return null;\n  }\n}\n\nexport default AAC;\n",
    "// This is mostly for support of the es6 module export\n// syntax with the babel compiler, it looks like it doesnt support\n// function exports like we are used to in node/commonjs\nmodule.exports = require('./wfs.js').default;\n",
    "/**\n * [js-crc]{@link https://github.com/emn178/js-crc}\n *\n * @namespace crc\n * @version 0.2.0\n * @author Chen, Yi-Cyuan [emn178@gmail.com]\n * @copyright Chen, Yi-Cyuan 2015-2017\n * @license MIT\n */\n/*jslint bitwise: true */\n(function () {\n  'use strict';\n\n  var root = typeof window === 'object' ? window : {};\n  var NODE_JS = !root.JS_CRC_NO_NODE_JS && typeof process === 'object' && process.versions && process.versions.node;\n  if (NODE_JS) {\n    root = global;\n  }\n  var COMMON_JS = !root.JS_CRC_NO_COMMON_JS && typeof module === 'object' && module.exports;\n  var AMD = typeof define === 'function' && define.amd;\n  var ARRAY_BUFFER = !root.JS_CRC_NO_ARRAY_BUFFER && typeof ArrayBuffer !== 'undefined';\n  var HEX_CHARS = '0123456789abcdef'.split('');\n\n  var Modules = [\n    {\n      name: 'crc32',\n      polynom: 0xEDB88320,\n      initValue: -1,\n      bytes: 4\n    }, \n    {\n      name: 'crc16',\n      polynom: 0xA001,\n      initValue: 0,\n      bytes: 2\n    }\n  ];\n\n  var i, j, k, b;\n  for (i = 0; i < Modules.length; ++i) {\n    var m = Modules[i];\n    m.method = (function (m) {\n      return function (message) {\n        return crc(message, m);\n      };\n    })(m);\n    m.table = [];\n    for (j = 0; j < 256; ++j) {\n      b = j;\n      for (k = 0; k < 8; ++k) {\n        b = b & 1 ? m.polynom ^ (b >>> 1) : b >>> 1;\n      }\n      m.table[j] = b >>> 0;\n    }\n  }\n\n  var crc = function (message, module) {\n    var notString = typeof message !== 'string';\n    if (notString && ARRAY_BUFFER && message instanceof ArrayBuffer) {\n      message = new Uint8Array(message);\n    }\n\n    var crc = module.initValue, code, i, length = message.length, table = module.table;\n    if (notString) {\n      for (i = 0; i < length; ++i) {\n        crc = table[(crc ^ message[i]) & 0xFF] ^ (crc >>> 8);\n      }\n    } else {\n      for (i = 0; i < length; ++i) {\n        code = message.charCodeAt(i);\n        if (code < 0x80) {\n          crc = table[(crc ^ code) & 0xFF] ^ (crc >>> 8);\n        } else if (code < 0x800) {\n          crc = table[(crc ^ (0xc0 | (code >> 6))) & 0xFF] ^ (crc >>> 8);\n          crc = table[(crc ^ (0x80 | (code & 0x3f))) & 0xFF] ^ (crc >>> 8);\n        } else if (code < 0xd800 || code >= 0xe000) {\n          crc = table[(crc ^ (0xe0 | (code >> 12))) & 0xFF] ^ (crc >>> 8);\n          crc = table[(crc ^ (0x80 | ((code >> 6) & 0x3f))) & 0xFF] ^ (crc >>> 8);\n          crc = table[(crc ^ (0x80 | (code & 0x3f))) & 0xFF] ^ (crc >>> 8);\n        } else {\n          code = 0x10000 + (((code & 0x3ff) << 10) | (message.charCodeAt(++i) & 0x3ff));\n          crc = table[(crc ^ (0xf0 | (code >> 18))) & 0xFF] ^ (crc >>> 8);\n          crc = table[(crc ^ (0x80 | ((code >> 12) & 0x3f))) & 0xFF] ^ (crc >>> 8);\n          crc = table[(crc ^ (0x80 | ((code >> 6) & 0x3f))) & 0xFF] ^ (crc >>> 8);\n          crc = table[(crc ^ (0x80 | (code & 0x3f))) & 0xFF] ^ (crc >>> 8);\n        }\n      }\n    }\n    crc ^= module.initValue;\n\n    var hex = '';\n    if (module.bytes > 2) {\n      hex += HEX_CHARS[(crc >> 28) & 0x0F] + HEX_CHARS[(crc >> 24) & 0x0F] +\n             HEX_CHARS[(crc >> 20) & 0x0F] + HEX_CHARS[(crc >> 16) & 0x0F];\n    }\n    hex += HEX_CHARS[(crc >> 12) & 0x0F] + HEX_CHARS[(crc >> 8) & 0x0F] +\n           HEX_CHARS[(crc >> 4) & 0x0F] + HEX_CHARS[crc & 0x0F];\n    return hex;\n  };\n\n  var exports = {};\n  for (i = 0;i < Modules.length;++i) {\n    var m = Modules[i];\n    exports[m.name] = m.method;\n  }\n  if (COMMON_JS) {\n    module.exports = exports;\n  } else {\n    for (i = 0;i < Modules.length;++i) {\n      var m = Modules[i];\n      root[m.name] = m.method;\n    }\n    if (AMD) {\n      define(function() {\n        return exports;\n      });\n    }\n  }\n})();\n",
    "/*\n * File Loader\n*/\nimport Event from '../events';\nimport EventHandler from '../event-handler';\n \nclass FileLoader extends EventHandler {\n\n  constructor(wfs) {\n    super(wfs, \n      Event.FRAG_LOADING,\n      Event.FILE_HEAD_LOADING,\n      Event.FILE_DATA_LOADING);\n    this.loaders = {};\n  }\n\n  destroy() {\n    for (let loaderName in this.loaders) {\n      let loader = this.loaders[loaderName];\n      if (loader) {\n        loader.destroy();\n      }\n    }\n    this.loaders = {};\n    EventHandler.prototype.destroy.call(this);\n  }\n\n  onFileHeadLoading(data) {  \n    let config = this.wfs.config;\n    let loader  =  new config.loader(config);\n    let loaderContext, loaderConfig, loaderCallbacks;\n    loaderContext = { url : config.fmp4FileUrl };\n    loaderConfig = {  maxRetry : 0 , retryDelay : 0 };\n    loaderCallbacks = { onSuccess : this.fileloadheadsuccess.bind(this) };\n    loader.loadHead(loaderContext,loaderConfig,loaderCallbacks);\n  }\n\n  fileloadheadsuccess(response ) { \n    this.wfs.trigger(Event.FILE_HEAD_LOADED, { size: response});\n  }\n\n  onFileDataLoading(data) {\n    let config = this.wfs.config;\n    let loader  =  new config.loader(config);\n    let loaderContext, loaderConfig, loaderCallbacks;\n    loaderContext = { url : config.fmp4FileUrl,   responseType : 'arraybuffer', progressData : false};\n    let start = data.fileStart, end = data.fileEnd;\n    if (!isNaN(start) && !isNaN(end)) {\n      loaderContext.rangeStart = start;\n      loaderContext.rangeEnd = end; \n    }\n    loaderConfig = { timeout : config.fragLoadingTimeOut, maxRetry : 0 , retryDelay : 0, maxRetryDelay : config.fragLoadingMaxRetryTimeout};\n    loaderCallbacks = { onSuccess : this.fileloaddatasuccess.bind(this) };\n    loader.load(loaderContext,loaderConfig,loaderCallbacks);\n  }\n  \n  fileloaddatasuccess(response, stats, context) { \n    this.wfs.trigger(Event.FILE_DATA_LOADED, {payload: response.data, stats: stats});\n  }\n \n  loaderror(response, context) {\n    let loader = context.loader;\n    if (loader) {\n      loader.abort();\n    }\n    this.loaders[context.type] = undefined;\n  } \n\n  loadtimeout(stats, context) {\n    let loader = context.loader;\n    if (loader) {\n      loader.abort();\n    }\n    this.loaders[context.type] = undefined;\n  }\n \n  loadprogress(stats, context, data) {  \n    let frag = context.frag;\n    frag.loaded = stats.loaded; \n  }\n\n}\n\nexport default FileLoader;",
    "/*\n * Websocket Loader\n*/\n\nimport Event from '../events';\nimport EventHandler from '../event-handler';\nimport H264Demuxer from '../demux/h264-demuxer';\nimport crc  from './crc.js';\n\nclass WebsocketLoader extends EventHandler {\n\n  constructor(wfs) {\n    super(wfs, \n    Event.WEBSOCKET_ATTACHING,\n    Event.WEBSOCKET_DATA_UPLOADING,\n    Event.WEBSOCKET_MESSAGE_SENDING)   \n    this.buf = null;\n    this.h264Demuxer = new H264Demuxer(wfs);    \n    this.mediaType = undefined; \n    this.channelName = undefined; \n  }\n \n  destroy() { \n    EventHandler.prototype.destroy.call(this);\n  }\n\n  onWebsocketAttaching(data) {\n  \tthis.mediaType = data.mediaType; \n  \tthis.channelName = data.channelName;  \n    if( data.websocket instanceof WebSocket ) {\n      this.client = data.websocket;\n      this.client.onopen = this.initSocketClient.bind(this);   \n      this.client.onclose = function(e) {\n          console.log('Websocket Disconnected!');\n      }; \n    }    \n  }\n\n  initSocketClient(client){\n    this.client.binaryType = 'arraybuffer';\n    this.client.onmessage = this.receiveSocketMessage.bind(this);\n    this.wfs.trigger(Event.WEBSOCKET_MESSAGE_SENDING, {commandType: \"open\", channelName:this.channelName, commandValue:\"NA\" });\n    console.log('Websocket Open!'); \n  }\n \n  receiveSocketMessage( event ){\n    var buffer = new Uint8Array(event.data);\n    console.log(buffer.length);\n    var newBuffer;\n    if(this.buf){\n      newBuffer = new Uint8Array(this.buf.byteLength + buffer.byteLength);\n      newBuffer.set(this.buf);\n      newBuffer.set(buffer, this.buf.byteLength);\n      console.log(newBuffer.length);\n    }\n    else\n      newBuffer = new Uint8Array(buffer);\n    //get len\n    var offset = 0;\n    var lenView = new DataView(newBuffer.buffer);\n    var len = lenView.getUint32(0);  \n    while(len < newBuffer.byteLength -4){\n      console.log(\"frames, len:\" + len);\n      var copy = newBuffer.subarray(4, len+4);\n      this.wfs.trigger(Event.H264_DATA_PARSING, {data: copy});\n      //var copy2 = new Uint8Array(0);\n      //this.wfs.trigger(Event.H264_DATA_PARSING, {data: copy2});\n      //this.wfs.trigger(Event.H264_DATA_PARSING, {data: copy2});\n      newBuffer = newBuffer.subarray(len+4);\n      offset  += (len+4);\n      len = lenView.getUint32(offset);\n      //get len\n    }\n    if(len === newBuffer.byteLength - 4){\n      var copy = newBuffer.subarray(4,len+4);\n      this.wfs.trigger(Event.H264_DATA_PARSING,{data:copy});\n      //var copy2 = new Uint8Array(0);\n      //this.wfs.trigger(Event.H264_DATA_PARSING,{data:copy2});\n      //this.wfs.trigger(Event.H264_DATA_PARSING,{data:copy2});\n      this.buf = null;\n    }\n    else\n      this.buf = new Uint8Array(newBuffer);\n/*\n    this.buf = new Uint8Array(event.data, 4);\n    //this.buf = new Uint8Array(event.data);\n    var buf_crc = new Uint8Array(event.data, 0, 4);\n    var copy = new Uint8Array(this.buf);  \n    \n    if (this.mediaType ==='FMp4'){\n      this.wfs.trigger(Event.WEBSOCKET_ATTACHED, {payload: copy });\n    } \n    if (this.mediaType === 'H264Raw'){\n      console.log(copy.length);\n      var crc16 = crc.crc16;\n      var crc32 = crc.crc32;\n      var crc_s = crc16(copy);\n      var buf_crc_s =  (buf_crc.map(String.fromCharCode)).join(\"\");\n      if(String.fromCharCode(buf_crc[0]) == crc_s[0] &&\n\t String.fromCharCode(buf_crc[1]) == crc_s[1] &&\n\t String.fromCharCode(buf_crc[2]) == crc_s[2] &&\n\t String.fromCharCode(buf_crc[3]) == crc_s[3]){\n\t//\t\tconsole.log(\"equal\");\t\n      }\n      else\n\tconsole.log(\"not equal\");\n     // console.log(crc_s);\n      this.wfs.trigger(Event.H264_DATA_PARSING, {data: copy });\n    }\n*/   \n  }\n\n  onWebsocketDataUploading( event ){\n    this.client.send( event.data );\n  }\n  \n  onWebsocketMessageSending( event ){  \n    this.client.send( JSON.stringify({ t: event.commandType, c:event.channelName, v: event.commandValue  }) );\n  }\n\n}\n\nexport default WebsocketLoader;  \n",
    "/**\n * Generate MP4 Box\n*/\n\n//import Hex from '../utils/hex';\nclass MP4 {\n  static init() {\n    MP4.types = {\n      avc1: [], // codingname\n      avcC: [],\n      btrt: [],\n      dinf: [],\n      dref: [],\n      esds: [],\n      ftyp: [],\n      hdlr: [],\n      mdat: [],\n      mdhd: [],\n      mdia: [],\n      mfhd: [],\n      minf: [],\n      moof: [],\n      moov: [],\n      mp4a: [],\n      mvex: [],\n      mvhd: [],\n      sdtp: [],\n      stbl: [],\n      stco: [],\n      stsc: [],\n      stsd: [],\n      stsz: [],\n      stts: [],\n      tfdt: [],\n      tfhd: [],\n      traf: [],\n      trak: [],\n      trun: [],\n      trex: [],\n      tkhd: [],\n      vmhd: [],\n      smhd: []\n    };\n\n    var i;\n    for (i in MP4.types) {\n      if (MP4.types.hasOwnProperty(i)) {\n        MP4.types[i] = [\n          i.charCodeAt(0),\n          i.charCodeAt(1),\n          i.charCodeAt(2),\n          i.charCodeAt(3)\n        ];\n      }\n    }\n\n    var videoHdlr = new Uint8Array([\n      0x00, // version 0\n      0x00, 0x00, 0x00, // flags\n      0x00, 0x00, 0x00, 0x00, // pre_defined\n      0x76, 0x69, 0x64, 0x65, // handler_type: 'vide'\n      0x00, 0x00, 0x00, 0x00, // reserved\n      0x00, 0x00, 0x00, 0x00, // reserved\n      0x00, 0x00, 0x00, 0x00, // reserved\n      0x56, 0x69, 0x64, 0x65,\n      0x6f, 0x48, 0x61, 0x6e,\n      0x64, 0x6c, 0x65, 0x72, 0x00 // name: 'VideoHandler'\n    ]);\n\n    var audioHdlr = new Uint8Array([\n      0x00, // version 0\n      0x00, 0x00, 0x00, // flags\n      0x00, 0x00, 0x00, 0x00, // pre_defined\n      0x73, 0x6f, 0x75, 0x6e, // handler_type: 'soun'\n      0x00, 0x00, 0x00, 0x00, // reserved\n      0x00, 0x00, 0x00, 0x00, // reserved\n      0x00, 0x00, 0x00, 0x00, // reserved\n      0x53, 0x6f, 0x75, 0x6e,\n      0x64, 0x48, 0x61, 0x6e,\n      0x64, 0x6c, 0x65, 0x72, 0x00 // name: 'SoundHandler'\n    ]);\n\n    MP4.HDLR_TYPES = {\n      'video': videoHdlr,\n      'audio': audioHdlr\n    };\n\n    var dref = new Uint8Array([\n      0x00, // version 0\n      0x00, 0x00, 0x00, // flags\n      0x00, 0x00, 0x00, 0x01, // entry_count\n      0x00, 0x00, 0x00, 0x0c, // entry_size\n      0x75, 0x72, 0x6c, 0x20, // 'url' type\n      0x00, // version 0\n      0x00, 0x00, 0x01 // entry_flags\n    ]);\n\n    var stco = new Uint8Array([\n      0x00, // version\n      0x00, 0x00, 0x00, // flags\n      0x00, 0x00, 0x00, 0x00 // entry_count\n    ]);\n\n    MP4.STTS = MP4.STSC = MP4.STCO = stco;\n\n    MP4.STSZ = new Uint8Array([\n      0x00, // version\n      0x00, 0x00, 0x00, // flags\n      0x00, 0x00, 0x00, 0x00, // sample_size\n      0x00, 0x00, 0x00, 0x00, // sample_count\n    ]);\n    MP4.VMHD = new Uint8Array([\n      0x00, // version\n      0x00, 0x00, 0x01, // flags\n      0x00, 0x00, // graphicsmode\n      0x00, 0x00,\n      0x00, 0x00,\n      0x00, 0x00 // opcolor\n    ]);\n    MP4.SMHD = new Uint8Array([\n      0x00, // version\n      0x00, 0x00, 0x00, // flags\n      0x00, 0x00, // balance\n      0x00, 0x00 // reserved\n    ]);\n\n    MP4.STSD = new Uint8Array([\n      0x00, // version 0\n      0x00, 0x00, 0x00, // flags\n      0x00, 0x00, 0x00, 0x01]);// entry_count\n\n    var majorBrand = new Uint8Array([105,115,111,109]); // isom\n    var avc1Brand = new Uint8Array([97,118,99,49]); // avc1\n    var minorVersion = new Uint8Array([0, 0, 0, 1]);\n\n    MP4.FTYP = MP4.box(MP4.types.ftyp, majorBrand, minorVersion, majorBrand, avc1Brand);\n    MP4.DINF = MP4.box(MP4.types.dinf, MP4.box(MP4.types.dref, dref));\n  }\n\n  static box(type) {\n  var\n    payload = Array.prototype.slice.call(arguments, 1),\n    size = 8,\n    i = payload.length,\n    len = i,\n    result;\n    // calculate the total size we need to allocate\n    while (i--) {\n      size += payload[i].byteLength;\n    }\n    result = new Uint8Array(size);\n    result[0] = (size >> 24) & 0xff;\n    result[1] = (size >> 16) & 0xff;\n    result[2] = (size >> 8) & 0xff;\n    result[3] = size  & 0xff;\n    result.set(type, 4);\n    // copy the payload into the result\n    for (i = 0, size = 8; i < len; i++) {\n      // copy payload[i] array @ offset size\n      result.set(payload[i], size);\n      size += payload[i].byteLength;\n    }\n    return result;\n  }\n\n  static hdlr(type) {\n    return MP4.box(MP4.types.hdlr, MP4.HDLR_TYPES[type]);\n  }\n\n  static mdat(data) {\n  //  console.log( \"mdat==> \",data.length );\n    return MP4.box(MP4.types.mdat, data);\n  }\n\n  static mdhd(timescale, duration) {\n    duration *= timescale;\n    return MP4.box(MP4.types.mdhd, new Uint8Array([\n      0x00, // version 0\n      0x00, 0x00, 0x00, // flags\n      0x00, 0x00, 0x00, 0x02, // creation_time\n      0x00, 0x00, 0x00, 0x03, // modification_time\n      (timescale >> 24) & 0xFF,\n      (timescale >> 16) & 0xFF,\n      (timescale >>  8) & 0xFF,\n      timescale & 0xFF, // timescale\n      (duration >> 24),\n      (duration >> 16) & 0xFF,\n      (duration >>  8) & 0xFF,\n      duration & 0xFF, // duration\n      0x55, 0xc4, // 'und' language (undetermined)\n      0x00, 0x00\n    ]));\n  }\n\n  static mdia(track) {\n    return MP4.box(MP4.types.mdia, MP4.mdhd(track.timescale, track.duration), MP4.hdlr(track.type), MP4.minf(track));\n  }\n\n  static mfhd(sequenceNumber) {\n    return MP4.box(MP4.types.mfhd, new Uint8Array([\n      0x00,\n      0x00, 0x00, 0x00, // flags\n      (sequenceNumber >> 24),\n      (sequenceNumber >> 16) & 0xFF,\n      (sequenceNumber >>  8) & 0xFF,\n      sequenceNumber & 0xFF, // sequence_number\n    ]));\n  }\n\n  static minf(track) {\n    if (track.type === 'audio') {\n      return MP4.box(MP4.types.minf, MP4.box(MP4.types.smhd, MP4.SMHD), MP4.DINF, MP4.stbl(track));\n    } else {\n      return MP4.box(MP4.types.minf, MP4.box(MP4.types.vmhd, MP4.VMHD), MP4.DINF, MP4.stbl(track));\n    }\n  }\n\n  static moof(sn, baseMediaDecodeTime, track) {\n    return MP4.box(MP4.types.moof, MP4.mfhd(sn), MP4.traf(track,baseMediaDecodeTime));\n  }\n/**\n * @param tracks... (optional) {array} the tracks associated with this movie\n */\n  static moov(tracks) {\n    var\n      i = tracks.length,\n      boxes = [];\n\n    while (i--) {\n      boxes[i] = MP4.trak(tracks[i]);\n    }\n\n    return MP4.box.apply(null, [MP4.types.moov, MP4.mvhd(tracks[0].timescale, tracks[0].duration)].concat(boxes).concat(MP4.mvex(tracks)));\n  }\n\n  static mvex(tracks) {\n    var\n      i = tracks.length,\n      boxes = [];\n\n    while (i--) {\n      boxes[i] = MP4.trex(tracks[i]);\n    }\n    return MP4.box.apply(null, [MP4.types.mvex].concat(boxes));\n  }\n\n  static mvhd(timescale,duration) {\n    //duration*=timescale;\n    duration = 0;\n    var\n      bytes = new Uint8Array([\n        0x00, // version 0\n        0x00, 0x00, 0x00, // flags\n        0x00, 0x00, 0x00, 0x01, // creation_time\n        0x00, 0x00, 0x00, 0x02, // modification_time\n        (timescale >> 24) & 0xFF,\n        (timescale >> 16) & 0xFF,\n        (timescale >>  8) & 0xFF,\n        timescale & 0xFF, // timescale\n        (duration >> 24) & 0xFF,\n        (duration >> 16) & 0xFF,\n        (duration >>  8) & 0xFF,\n        duration & 0xFF, // duration\n        0x00, 0x01, 0x00, 0x00, // 1.0 rate\n        0x01, 0x00, // 1.0 volume\n        0x00, 0x00, // reserved\n        0x00, 0x00, 0x00, 0x00, // reserved\n        0x00, 0x00, 0x00, 0x00, // reserved\n        0x00, 0x01, 0x00, 0x00,\n        0x00, 0x00, 0x00, 0x00,\n        0x00, 0x00, 0x00, 0x00,\n        0x00, 0x00, 0x00, 0x00,\n        0x00, 0x01, 0x00, 0x00,\n        0x00, 0x00, 0x00, 0x00,\n        0x00, 0x00, 0x00, 0x00,\n        0x00, 0x00, 0x00, 0x00,\n        0x40, 0x00, 0x00, 0x00, // transformation: unity matrix\n        0x00, 0x00, 0x00, 0x00,\n        0x00, 0x00, 0x00, 0x00,\n        0x00, 0x00, 0x00, 0x00,\n        0x00, 0x00, 0x00, 0x00,\n        0x00, 0x00, 0x00, 0x00,\n        0x00, 0x00, 0x00, 0x00, // pre_defined\n        0xff, 0xff, 0xff, 0xff // next_track_ID\n      ]);\n    return MP4.box(MP4.types.mvhd, bytes);\n  }\n\n  static sdtp(track) {\n    var\n      samples = track.samples || [],\n      bytes = new Uint8Array(4 + samples.length),\n      flags,\n      i;\n    // leave the full box header (4 bytes) all zero\n    // write the sample table\n    for (i = 0; i < samples.length; i++) {\n      flags = samples[i].flags;\n      bytes[i + 4] = (flags.dependsOn << 4) |\n        (flags.isDependedOn << 2) |\n        (flags.hasRedundancy);\n    }\n\n    return MP4.box(MP4.types.sdtp, bytes);\n  }\n\n  static stbl(track) {\n    return MP4.box(MP4.types.stbl, MP4.stsd(track), MP4.box(MP4.types.stts, MP4.STTS), MP4.box(MP4.types.stsc, MP4.STSC), MP4.box(MP4.types.stsz, MP4.STSZ), MP4.box(MP4.types.stco, MP4.STCO));\n  }\n\n  static avc1(track) {\n    var sps = [], pps = [], i, data, len;\n    // assemble the SPSs\n\n    for (i = 0; i < track.sps.length; i++) {\n      data = track.sps[i];\n      len = data.byteLength;\n      sps.push((len >>> 8) & 0xFF);\n      sps.push((len & 0xFF));\n      sps = sps.concat(Array.prototype.slice.call(data)); // SPS\n    }\n\n    // assemble the PPSs\n    for (i = 0; i < track.pps.length; i++) {\n      data = track.pps[i];\n      len = data.byteLength;\n      pps.push((len >>> 8) & 0xFF);\n      pps.push((len & 0xFF));\n      pps = pps.concat(Array.prototype.slice.call(data));\n    }\n\n    var avcc = MP4.box(MP4.types.avcC, new Uint8Array([\n            0x01,   // version\n            sps[3], // profile\n            sps[4], // profile compat\n            sps[5], // level\n            0xfc | 3, // lengthSizeMinusOne, hard-coded to 4 bytes\n            0xE0 | track.sps.length // 3bit reserved (111) + numOfSequenceParameterSets\n          ].concat(sps).concat([\n            track.pps.length // numOfPictureParameterSets\n          ]).concat(pps))), // \"PPS\"\n        width = track.width,\n        height = track.height;\n    //console.log('avcc:' + Hex.hexDump(avcc));\n    return MP4.box(MP4.types.avc1, new Uint8Array([\n        0x00, 0x00, 0x00, // reserved\n        0x00, 0x00, 0x00, // reserved\n        0x00, 0x01, // data_reference_index\n        0x00, 0x00, // pre_defined\n        0x00, 0x00, // reserved\n        0x00, 0x00, 0x00, 0x00,\n        0x00, 0x00, 0x00, 0x00,\n        0x00, 0x00, 0x00, 0x00, // pre_defined\n        (width >> 8) & 0xFF,\n        width & 0xff, // width\n        (height >> 8) & 0xFF,\n        height & 0xff, // height\n        0x00, 0x48, 0x00, 0x00, // horizresolution\n        0x00, 0x48, 0x00, 0x00, // vertresolution\n        0x00, 0x00, 0x00, 0x00, // reserved\n        0x00, 0x01, // frame_count\n        0x12,\n        0x6a, 0x65, 0x66, 0x66, // wfs.js\n        0x2d, 0x79, 0x61, 0x6e,\n        0x2f, 0x2f, 0x2f, 0x67,\n        0x77, 0x66, 0x73, 0x2E,\n        0x6A, 0x73, 0x00, 0x00,\n        0x00, 0x00, 0x00, 0x00,\n        0x00, 0x00, 0x00, 0x00,\n        0x00, 0x00, 0x00, // compressorname\n        0x00, 0x18,   // depth = 24\n        0x11, 0x11]), // pre_defined = -1\n          avcc,\n          MP4.box(MP4.types.btrt, new Uint8Array([\n            0x00, 0x1c, 0x9c, 0x80, // bufferSizeDB\n            0x00, 0x2d, 0xc6, 0xc0, // maxBitrate\n            0x00, 0x2d, 0xc6, 0xc0])) // avgBitrate\n          );\n  }       \n\n  static esds(track) {\n    var configlen = track.config.length;\n    return new Uint8Array([\n      0x00, // version 0\n      0x00, 0x00, 0x00, // flags\n\n      0x03, // descriptor_type\n      0x17+configlen, // length\n      0x00, 0x01, //es_id\n      0x00, // stream_priority\n\n      0x04, // descriptor_type\n      0x0f+configlen, // length\n      0x40, //codec : mpeg4_audio\n      0x15, // stream_type\n      0x00, 0x00, 0x00, // buffer_size\n      0x00, 0x00, 0x00, 0x00, // maxBitrate\n      0x00, 0x00, 0x00, 0x00, // avgBitrate\n\n      0x05 // descriptor_type\n      ].concat([configlen]).concat(track.config).concat([0x06, 0x01, 0x02])); // GASpecificConfig)); // length + audio config descriptor\n  }\n\n  static mp4a(track) {\n    var audiosamplerate = track.audiosamplerate;\n      return MP4.box(MP4.types.mp4a, new Uint8Array([\n      0x00, 0x00, 0x00, // reserved\n      0x00, 0x00, 0x00, // reserved\n      0x00, 0x01, // data_reference_index\n      0x00, 0x00, 0x00, 0x00,\n      0x00, 0x00, 0x00, 0x00, // reserved\n      0x00, track.channelCount, // channelcount\n      0x00, 0x10, // sampleSize:16bits\n      0x00, 0x00, 0x00, 0x00, // reserved2\n      (audiosamplerate >> 8) & 0xFF,\n      audiosamplerate & 0xff, //\n      0x00, 0x00]),\n      MP4.box(MP4.types.esds, MP4.esds(track)));\n  }\n\n  static stsd(track) {\n    if (track.type === 'audio') {\n      return MP4.box(MP4.types.stsd, MP4.STSD, MP4.mp4a(track));\n    } else {\n      return MP4.box(MP4.types.stsd, MP4.STSD, MP4.avc1(track));\n    }\n  }\n\n  static tkhd(track) {\n    var id = track.id,\n        duration = track.duration*track.timescale,\n        width = track.width,\n        height = track.height;\n\n     //   console.log( \"tkhd==> \",track.id, track.duration, track.timescale, width,height );\n\n    return MP4.box(MP4.types.tkhd, new Uint8Array([\n      0x00, // version 0\n      0x00, 0x00, 0x07, // flags\n      0x00, 0x00, 0x00, 0x00, // creation_time\n      0x00, 0x00, 0x00, 0x00, // modification_time\n      (id >> 24) & 0xFF,\n      (id >> 16) & 0xFF,\n      (id >> 8) & 0xFF,\n      id & 0xFF, // track_ID\n      0x00, 0x00, 0x00, 0x00, // reserved\n      (duration >> 24),\n      (duration >> 16) & 0xFF,\n      (duration >>  8) & 0xFF,\n      duration & 0xFF, // duration\n      0x00, 0x00, 0x00, 0x00,\n      0x00, 0x00, 0x00, 0x00, // reserved\n      0x00, 0x00, // layer\n      0x00, 0x00, // alternate_group\n      0x00, 0x00, // non-audio track volume\n      0x00, 0x00, // reserved\n      0x00, 0x01, 0x00, 0x00,\n      0x00, 0x00, 0x00, 0x00,\n      0x00, 0x00, 0x00, 0x00,\n      0x00, 0x00, 0x00, 0x00,\n      0x00, 0x01, 0x00, 0x00,\n      0x00, 0x00, 0x00, 0x00,\n      0x00, 0x00, 0x00, 0x00,\n      0x00, 0x00, 0x00, 0x00,\n      0x40, 0x00, 0x00, 0x00, // transformation: unity matrix\n      (width >> 8) & 0xFF,\n      width & 0xFF,\n      0x00, 0x00, // width\n      (height >> 8) & 0xFF,\n      height & 0xFF,\n      0x00, 0x00 // height\n    ]));\n  }\n\n  static traf(track,baseMediaDecodeTime) {\n    var sampleDependencyTable = MP4.sdtp(track),\n        id = track.id;\n      \n\n\n     //  console.log( \"traf==> \",id ,baseMediaDecodeTime);\n\n    return MP4.box(MP4.types.traf,\n               MP4.box(MP4.types.tfhd, new Uint8Array([\n                 0x00, // version 0\n                 0x00, 0x00, 0x00, // flags\n                 (id >> 24),\n                 (id >> 16) & 0XFF,\n                 (id >> 8) & 0XFF,\n                 (id & 0xFF) // track_ID\n               ])),\n               MP4.box(MP4.types.tfdt, new Uint8Array([\n                 0x00, // version 0\n                 0x00, 0x00, 0x00, // flags\n                 (baseMediaDecodeTime >>24),\n                 (baseMediaDecodeTime >> 16) & 0XFF,\n                 (baseMediaDecodeTime >> 8) & 0XFF,\n                 (baseMediaDecodeTime & 0xFF) // baseMediaDecodeTime\n               ])),\n               MP4.trun(track,\n                    sampleDependencyTable.length +\n                    16 + // tfhd\n                    16 + // tfdt\n                    8 +  // traf header\n                    16 + // mfhd\n                    8 +  // moof header\n                    8),  // mdat header\n               sampleDependencyTable);\n  }\n\n  /**\n   * Generate a track box.\n   * @param track {object} a track definition\n   * @return {Uint8Array} the track box\n   */\n  static trak(track) {\n    track.duration = track.duration || 0xffffffff;\n    return MP4.box(MP4.types.trak, MP4.tkhd(track), MP4.mdia(track));\n  }\n\n  static trex(track) {\n    var id = track.id;\n    return MP4.box(MP4.types.trex, new Uint8Array([\n      0x00, // version 0\n      0x00, 0x00, 0x00, // flags\n     (id >> 24),\n     (id >> 16) & 0XFF,\n     (id >> 8) & 0XFF,\n     (id & 0xFF), // track_ID\n      0x00, 0x00, 0x00, 0x01, // default_sample_description_index\n      0x00, 0x00, 0x00, 0x00, // default_sample_duration\n      0x00, 0x00, 0x00, 0x00, // default_sample_size\n      0x00, 0x01, 0x00, 0x01 // default_sample_flags\n    ]));\n  }\n\n  static trun(track, offset) {\n    var samples= track.samples || [],\n        len = samples.length,\n        arraylen = 12 + (16 * len),\n        array = new Uint8Array(arraylen),\n        i,sample,duration,size,flags,cts;\n\n//sample = samples[0];\n //       console.log( \"trun==> \",sample.duration, sample.cts ,sample.size,len );\n\n    offset += 8 + arraylen;\n    array.set([\n      0x00, // version 0\n      0x00, 0x0f, 0x01, // flags\n      (len >>> 24) & 0xFF,\n      (len >>> 16) & 0xFF,\n      (len >>> 8) & 0xFF,\n      len & 0xFF, // sample_count\n      (offset >>> 24) & 0xFF,\n      (offset >>> 16) & 0xFF,\n      (offset >>> 8) & 0xFF,\n      offset & 0xFF // data_offset\n    ],0);\n    for (i = 0; i < len; i++) {\n      sample = samples[i];\n      duration = sample.duration;\n      size = sample.size;\n      flags = sample.flags;\n      cts = sample.cts;\n      array.set([\n        (duration >>> 24) & 0xFF,\n        (duration >>> 16) & 0xFF,\n        (duration >>> 8) & 0xFF,\n        duration & 0xFF, // sample_duration\n        (size >>> 24) & 0xFF,\n        (size >>> 16) & 0xFF,\n        (size >>> 8) & 0xFF,\n        size & 0xFF, // sample_size\n        (flags.isLeading << 2) | flags.dependsOn,\n        (flags.isDependedOn << 6) |\n          (flags.hasRedundancy << 4) |\n          (flags.paddingValue << 1) |\n          flags.isNonSync,\n        flags.degradPrio & 0xF0 << 8,\n        flags.degradPrio & 0x0F, // sample_flags\n        (cts >>> 24) & 0xFF,\n        (cts >>> 16) & 0xFF,\n        (cts >>> 8) & 0xFF,\n        cts & 0xFF // sample_composition_time_offset\n      ],12+16*i);\n    }\n    return MP4.box(MP4.types.trun, array);\n  }\n\n  static initSegment(tracks) {\n    if (!MP4.types) {\n      MP4.init();\n    }\n    var movie = MP4.moov(tracks), result;\n    result = new Uint8Array(MP4.FTYP.byteLength + movie.byteLength);\n    result.set(MP4.FTYP);\n    result.set(movie, MP4.FTYP.byteLength);\n\n \n    return result;\n  }\n}\n\nexport default MP4;\n",
    "/**\n * fMP4 remuxer\n*/\nimport AAC from '../helper/aac';\nimport Event from '../events';\nimport {logger} from '../utils/logger';\nimport MP4 from '../remux/mp4-generator';\nimport {ErrorTypes, ErrorDetails} from '../errors';\nimport '../utils/polyfill';\n\nclass MP4Remuxer {\n  constructor(observer, id, config) {\n    this.observer = observer;\n    this.id = id;\n    this.config = config;\n    this.ISGenerated = false;\n    this.PES2MP4SCALEFACTOR = 4;\n    this.PES_TIMESCALE = 90000;\n    this.MP4_TIMESCALE = this.PES_TIMESCALE / this.PES2MP4SCALEFACTOR;\n    this.nextAvcDts = 90300;\n    this.H264_TIMEBASE = 3000;\n  }\n\n  get passthrough() {\n    return false;\n  }\n\n  destroy() {\n  }\n\n  insertDiscontinuity() {\n    this._initPTS = this._initDTS = undefined;\n  }\n\n  switchLevel() {\n    this.ISGenerated = false;\n  }\n   \n  pushVideo(level, sn, videoTrack, timeOffset, contiguous) {    \n    this.level = level;\n    this.sn = sn;\n    let videoData;\n    // generate Init Segment if needed\n    if (!this.ISGenerated) {\n      this.generateVideoIS(videoTrack,timeOffset);\n    }    \n    if (this.ISGenerated) {\n     // if (videoTrack.samples.length) { \n        this.remuxVideo_2(videoTrack,timeOffset,contiguous);   \n     // }\n    }  \n  }\n \n  remuxVideo_2(track, timeOffset, contiguous, audioTrackLength) {\n    var offset = 8,\n      pesTimeScale = this.PES_TIMESCALE,\n      pes2mp4ScaleFactor = this.PES2MP4SCALEFACTOR,\n      mp4SampleDuration,\n      mdat, moof,\n      firstPTS, firstDTS,\n      nextDTS, \n      inputSamples = track.samples,\n      outputSamples = [];\n   \n    /* concatenate the video data and construct the mdat in place\n      (need 8 more bytes to fill length and mpdat type) */\n    mdat = new Uint8Array(track.len + (4 * track.nbNalu) + 8);\n    let view = new DataView(mdat.buffer);\n    view.setUint32(0, mdat.byteLength);\n    mdat.set(MP4.types.mdat, 4);   \n    var sampleDuration=0;\n    let ptsnorm, dtsnorm, mp4Sample, lastDTS;\n\n    for (let i = 0; i < inputSamples.length; i++) {\n      let avcSample = inputSamples[i],\n          mp4SampleLength = 0,\n          compositionTimeOffset;\n      // convert NALU bitstream to MP4 format (prepend NALU with size field)\n      while (avcSample.units.units.length) {\n        let unit = avcSample.units.units.shift();\n        view.setUint32(offset, unit.data.byteLength);\n        offset += 4;\n        mdat.set(unit.data, offset);\n        offset += unit.data.byteLength;\n        mp4SampleLength += 4 + unit.data.byteLength;\n      }\n    \n      let pts = avcSample.pts - this._initPTS;\n      let dts = avcSample.dts - this._initDTS; \n      dts = Math.min(pts,dts);\n\n      if (lastDTS !== undefined) {\n        ptsnorm = this._PTSNormalize(pts, lastDTS);\n        dtsnorm = this._PTSNormalize(dts, lastDTS);\n        sampleDuration = (dtsnorm - lastDTS)  \n        if (sampleDuration <= 0) {\n          logger.log (`invalid sample duration at PTS/DTS: ${avcSample.pts}/${avcSample.dts}|dts norm: ${dtsnorm}|lastDTS: ${lastDTS}:${sampleDuration}`);\n          sampleDuration = 1;\n        }\n      } else {\n        var nextAvcDts = this.nextAvcDts, delta;\n        ptsnorm = this._PTSNormalize(pts, nextAvcDts);\n        dtsnorm = this._PTSNormalize(dts, nextAvcDts);\n        if (nextAvcDts) {\n          delta = Math.round((dtsnorm - nextAvcDts) );\n          if (/*contiguous ||*/ Math.abs(delta) < 600) {\n            if (delta) {\n              if (delta > 1) {\n                logger.log (`AVC:${delta} ms hole between fragments detected,filling it`);\n              } else if (delta < -1) {\n                logger.log (`AVC:${(-delta)} ms overlapping between fragments detected`);\n              }\n              dtsnorm = nextAvcDts;\n              ptsnorm = Math.max(ptsnorm - delta, dtsnorm);\n              logger.log (`Video/PTS/DTS adjusted: ${ptsnorm}/${dtsnorm},delta:${delta}`);\n            }\n          }\n        }\n        this.firstPTS = Math.max(0, ptsnorm);\n        this.firstDTS = Math.max(0, dtsnorm);\n        sampleDuration = 0.03; \n      }\n \n      outputSamples.push({\n        size: mp4SampleLength,  \n        duration:  this.H264_TIMEBASE, \n        cts: 0,\n        flags: {\n          isLeading: 0,\n          isDependedOn: 0,\n          hasRedundancy: 0,\n          degradPrio: 0,\n          dependsOn : avcSample.key ? 2 : 1,\n          isNonSync : avcSample.key ? 0 : 1\n        }\n      });\n     lastDTS = dtsnorm;\n\n    }\n\n    var lastSampleDuration = 0;\n    if (outputSamples.length >= 2) {\n      lastSampleDuration = outputSamples[outputSamples.length - 2].duration;\n      outputSamples[0].duration = lastSampleDuration;\n    }\n    this.nextAvcDts = dtsnorm + lastSampleDuration;\n    let dropped = track.dropped;\n    track.len = 0;\n    track.nbNalu = 0;\n    track.dropped = 0;\n    if(outputSamples.length && navigator.userAgent.toLowerCase().indexOf('chrome') > -1) {\n      let flags = outputSamples[0].flags; \n      flags.dependsOn = 2;\n      flags.isNonSync = 0;\n    }\n    track.samples = outputSamples; \n    moof = MP4.moof(track.sequenceNumber++, dtsnorm  , track);\n    track.samples = [];\n\n    let data = {\n      id : this.id,\n      level : this.level,\n      sn : this.sn,\n      data1: moof,\n      data2: mdat,\n      startPTS: ptsnorm, \n      endPTS: ptsnorm, \n      startDTS: dtsnorm, \n      endDTS: dtsnorm, \n      type: 'video',\n      nb: outputSamples.length,\n      dropped : dropped\n    };\n    \n    this.observer.trigger(Event.FRAG_PARSING_DATA, data);    \n    return data;\n  }\n  \n  generateVideoIS(videoTrack,timeOffset) {\n    var observer = this.observer,       \n        videoSamples = videoTrack.samples,\n        pesTimeScale = this.PES_TIMESCALE,\n        tracks = {},\n        data = { id : this.id, level : this.level, sn : this.sn, tracks : tracks, unique : false },\n        computePTSDTS = (this._initPTS === undefined),\n        initPTS, initDTS;\n\n    if (computePTSDTS) {\n      initPTS = initDTS = Infinity;\n    }\n \n    if (videoTrack.sps && videoTrack.pps && videoSamples.length) {\n      videoTrack.timescale = 90000;//this.MP4_TIMESCALE;\n      tracks.video = {\n        container : 'video/mp4',\n        codec :  videoTrack.codec,\n        initSegment : MP4.initSegment([videoTrack]),\n        metadata : {\n          width : videoTrack.width,\n          height : videoTrack.height\n        }\n      };\n      if (computePTSDTS) { \n        initPTS = Math.min(initPTS,videoSamples[0].pts - this.H264_TIMEBASE);\n        initDTS = Math.min(initDTS,videoSamples[0].dts - this.H264_TIMEBASE );\n      }\n    }\n\n    if(Object.keys(tracks).length) {      \n      observer.trigger(Event.FRAG_PARSING_INIT_SEGMENT,data);      \n      this.ISGenerated = true;\n      if (computePTSDTS) {\n        this._initPTS = initPTS;\n        this._initDTS = initDTS; \n      }\n    } else {\n      console.log( \"generateVideoIS ERROR==> \", ErrorTypes.MEDIA_ERROR);  \n    }\n  }\n \n  remux(level,sn,audioTrack,videoTrack,id3Track,textTrack,timeOffset, contiguous) {\n    this.level = level;\n    this.sn = sn;\n    // generate Init Segment if needed\n    if (!this.ISGenerated) {\n      this.generateIS(audioTrack,videoTrack,timeOffset);\n    }\n\n    if (this.ISGenerated) {\n      // Purposefully remuxing audio before video, so that remuxVideo can use nextAacPts, which is\n      // calculated in remuxAudio.\n      //logger.log('nb AAC samples:' + audioTrack.samples.length);\n      if (audioTrack.samples.length) {\n        let audioData = this.remuxAudio(audioTrack,timeOffset,contiguous);\n        //logger.log('nb AVC samples:' + videoTrack.samples.length);\n        if (videoTrack.samples.length) {\n          let audioTrackLength;\n          if (audioData) {\n            audioTrackLength = audioData.endPTS - audioData.startPTS;\n          }\n          this.remuxVideo(videoTrack,timeOffset,contiguous,audioTrackLength);\n        }\n      } else {\n        let videoData;\n        //logger.log('nb AVC samples:' + videoTrack.samples.length);\n        if (videoTrack.samples.length) {\n          videoData = this.remuxVideo(videoTrack,timeOffset,contiguous);\n        }\n        if (videoData && audioTrack.codec) {\n          this.remuxEmptyAudio(audioTrack, timeOffset, contiguous, videoData);\n        }\n      }\n    }\n    //logger.log('nb ID3 samples:' + audioTrack.samples.length);\n    if (id3Track.samples.length) {\n      this.remuxID3(id3Track,timeOffset);\n    }\n    //logger.log('nb ID3 samples:' + audioTrack.samples.length);\n    if (textTrack.samples.length) {\n      this.remuxText(textTrack,timeOffset);\n    }\n    //notify end of parsing\n    this.observer.trigger(Event.FRAG_PARSED, { id : this.id , level : this.level, sn : this.sn});\n  }\n\n  generateIS(audioTrack,videoTrack,timeOffset) {\n    var observer = this.observer,\n        audioSamples = audioTrack.samples,\n        videoSamples = videoTrack.samples,\n        pesTimeScale = this.PES_TIMESCALE,\n        tracks = {},\n        data = { id : this.id, level : this.level, sn : this.sn, tracks : tracks, unique : false },\n        computePTSDTS = (this._initPTS === undefined),\n        initPTS, initDTS;\n\n    if (computePTSDTS) {\n      initPTS = initDTS = Infinity;\n    }\n    if (audioTrack.config && audioSamples.length) {\n      audioTrack.timescale = audioTrack.audiosamplerate;\n      // MP4 duration (track duration in seconds multiplied by timescale) is coded on 32 bits\n      // we know that each AAC sample contains 1024 frames....\n      // in order to avoid overflowing the 32 bit counter for large duration, we use smaller timescale (timescale/gcd)\n      // we just need to ensure that AAC sample duration will still be an integer (will be 1024/gcd)\n      if (audioTrack.timescale * audioTrack.duration > Math.pow(2, 32)) {\n        let greatestCommonDivisor = function(a, b) {\n            if ( ! b) {\n                return a;\n            }\n            return greatestCommonDivisor(b, a % b);\n        };\n        audioTrack.timescale = audioTrack.audiosamplerate / greatestCommonDivisor(audioTrack.audiosamplerate,1024);\n      }\n      logger.log ('audio mp4 timescale :'+ audioTrack.timescale);\n      tracks.audio = {\n        container : 'audio/mp4',\n        codec :  audioTrack.codec,\n        initSegment : MP4.initSegment([audioTrack]),\n        metadata : {\n          channelCount : audioTrack.channelCount\n        }\n      };\n      if (computePTSDTS) {\n        // remember first PTS of this demuxing context. for audio, PTS + DTS ...\n        initPTS = initDTS = audioSamples[0].pts - pesTimeScale * timeOffset;\n      }\n    }\n\n    if (videoTrack.sps && videoTrack.pps && videoSamples.length) {\n      videoTrack.timescale = this.MP4_TIMESCALE;\n      tracks.video = {\n        container : 'video/mp4',\n        codec :  videoTrack.codec,\n        initSegment : MP4.initSegment([videoTrack]),\n        metadata : {\n          width : videoTrack.width,\n          height : videoTrack.height\n        }\n      };\n      if (computePTSDTS) {\n        initPTS = Math.min(initPTS,videoSamples[0].pts - pesTimeScale * timeOffset);\n        initDTS = Math.min(initDTS,videoSamples[0].dts - pesTimeScale * timeOffset);\n      }\n    }\n\n    if(Object.keys(tracks).length) {\n      observer.trigger(Event.FRAG_PARSING_INIT_SEGMENT,data);\n      this.ISGenerated = true;\n      if (computePTSDTS) {\n        this._initPTS = initPTS;\n        this._initDTS = initDTS;\n      }\n    } else {\n      observer.trigger(Event.ERROR, {type : ErrorTypes.MEDIA_ERROR, id : this.id, details: ErrorDetails.FRAG_PARSING_ERROR, fatal: false, reason: 'no audio/video samples found'});\n    }\n  }\n\n  remuxVideo(track, timeOffset, contiguous, audioTrackLength) {\n    var offset = 8,\n        pesTimeScale = this.PES_TIMESCALE,\n        pes2mp4ScaleFactor = this.PES2MP4SCALEFACTOR,\n        mp4SampleDuration,\n        mdat, moof,\n        firstPTS, firstDTS,\n        nextDTS,\n        lastPTS, lastDTS,\n        inputSamples = track.samples,\n        outputSamples = [];\n\n  // PTS is coded on 33bits, and can loop from -2^32 to 2^32\n  // PTSNormalize will make PTS/DTS value monotonic, we use last known DTS value as reference value\n   let nextAvcDts;\n    if (contiguous) {\n      // if parsed fragment is contiguous with last one, let's use last DTS value as reference\n      nextAvcDts = this.nextAvcDts;\n    } else {\n      // if not contiguous, let's use target timeOffset\n      nextAvcDts = timeOffset*pesTimeScale;\n    }\n\n    // compute first DTS and last DTS, normalize them against reference value\n    let sample = inputSamples[0];\n    firstDTS =  Math.max(this._PTSNormalize(sample.dts,nextAvcDts) - this._initDTS,0);\n    firstPTS =  Math.max(this._PTSNormalize(sample.pts,nextAvcDts) - this._initDTS,0);\n \n    // check timestamp continuity accross consecutive fragments (this is to remove inter-fragment gap/hole)\n    let delta = Math.round((firstDTS - nextAvcDts) / 90);\n    // if fragment are contiguous, detect hole/overlapping between fragments\n    if (contiguous) {\n      if (delta) {\n        if (delta > 1) {\n          logger.log(`AVC:${delta} ms hole between fragments detected,filling it`);\n        } else if (delta < -1) {\n          logger.log(`AVC:${(-delta)} ms overlapping between fragments detected`);\n        }\n        // remove hole/gap : set DTS to next expected DTS\n        firstDTS = nextAvcDts;\n        inputSamples[0].dts = firstDTS + this._initDTS;\n        // offset PTS as well, ensure that PTS is smaller or equal than new DTS\n        firstPTS = Math.max(firstPTS - delta, nextAvcDts);\n        inputSamples[0].pts = firstPTS + this._initDTS;\n        logger.log(`Video/PTS/DTS adjusted: ${firstPTS}/${firstDTS},delta:${delta}`);\n      }\n    }\n    nextDTS = firstDTS;\n \n    // compute lastPTS/lastDTS\n    sample = inputSamples[inputSamples.length-1];\n    lastDTS = Math.max(this._PTSNormalize(sample.dts,nextAvcDts) - this._initDTS,0);\n    lastPTS = Math.max(this._PTSNormalize(sample.pts,nextAvcDts) - this._initDTS,0);\n    lastPTS = Math.max(lastPTS, lastDTS);\n\n    let vendor = navigator.vendor, userAgent = navigator.userAgent,\n        isSafari = vendor && vendor.indexOf('Apple') > -1 && userAgent && !userAgent.match('CriOS');\n\n      // on Safari let's signal the same sample duration for all samples\n      // sample duration (as expected by trun MP4 boxes), should be the delta between sample DTS\n      // set this constant duration as being the avg delta between consecutive DTS.\n    if (isSafari) {\n      mp4SampleDuration = Math.round((lastDTS-firstDTS)/(pes2mp4ScaleFactor*(inputSamples.length-1)));\n    }\n\n    // normalize all PTS/DTS now ...\n    for (let i = 0; i < inputSamples.length; i++) {\n      let sample = inputSamples[i];\n      if (isSafari) {\n        // sample DTS is computed using a constant decoding offset (mp4SampleDuration) between samples\n        sample.dts = firstDTS + i*pes2mp4ScaleFactor*mp4SampleDuration;\n      } else {\n        // ensure sample monotonic DTS\n        sample.dts = Math.max(this._PTSNormalize(sample.dts, nextAvcDts) - this._initDTS,firstDTS);\n        // ensure dts is a multiple of scale factor to avoid rounding issues\n        sample.dts = Math.round(sample.dts/pes2mp4ScaleFactor)*pes2mp4ScaleFactor;\n      }\n      // we normalize PTS against nextAvcDts, we also substract initDTS (some streams don't start @ PTS O)\n      // and we ensure that computed value is greater or equal than sample DTS\n      sample.pts = Math.max(this._PTSNormalize(sample.pts,nextAvcDts) - this._initDTS, sample.dts);\n      // ensure pts is a multiple of scale factor to avoid rounding issues\n      sample.pts = Math.round(sample.pts/pes2mp4ScaleFactor)*pes2mp4ScaleFactor;\n\n    }\n \n    /* concatenate the video data and construct the mdat in place\n      (need 8 more bytes to fill length and mpdat type) */\n    mdat = new Uint8Array(track.len + (4 * track.nbNalu) + 8);\n    let view = new DataView(mdat.buffer);\n    view.setUint32(0, mdat.byteLength);\n    mdat.set(MP4.types.mdat, 4);\n\n    for (let i = 0; i < inputSamples.length; i++) {\n      let avcSample = inputSamples[i],\n          mp4SampleLength = 0,\n          compositionTimeOffset;\n      // convert NALU bitstream to MP4 format (prepend NALU with size field)\n      while (avcSample.units.units.length) {\n        let unit = avcSample.units.units.shift();\n        view.setUint32(offset, unit.data.byteLength);\n        offset += 4;\n        mdat.set(unit.data, offset);\n        offset += unit.data.byteLength;\n        mp4SampleLength += 4 + unit.data.byteLength;\n      }\n\n      if(!isSafari) {\n        // expected sample duration is the Decoding Timestamp diff of consecutive samples\n        if (i < inputSamples.length - 1) {\n          mp4SampleDuration = inputSamples[i+1].dts - avcSample.dts;\n        } else {\n          let config = this.config,\n              lastFrameDuration = avcSample.dts - inputSamples[i > 0 ? i-1 : i].dts;\n          if (config.stretchShortVideoTrack) {\n            // In some cases, a segment's audio track duration may exceed the video track duration.\n            // Since we've already remuxed audio, and we know how long the audio track is, we look to\n            // see if the delta to the next segment is longer than the minimum of maxBufferHole and\n            // maxSeekHole. If so, playback would potentially get stuck, so we artificially inflate\n            // the duration of the last frame to minimize any potential gap between segments.\n            let maxBufferHole = config.maxBufferHole,\n                maxSeekHole = config.maxSeekHole,\n                gapTolerance = Math.floor(Math.min(maxBufferHole, maxSeekHole) * pesTimeScale),\n                deltaToFrameEnd = (audioTrackLength ? firstPTS + audioTrackLength * pesTimeScale : this.nextAacPts) - avcSample.pts;\n            if (deltaToFrameEnd > gapTolerance) {\n              // We subtract lastFrameDuration from deltaToFrameEnd to try to prevent any video\n              // frame overlap. maxBufferHole/maxSeekHole should be >> lastFrameDuration anyway.\n              mp4SampleDuration = deltaToFrameEnd - lastFrameDuration;\n              if (mp4SampleDuration < 0) {\n                mp4SampleDuration = lastFrameDuration;\n              }\n              logger.log(`It is approximately ${deltaToFrameEnd/90} ms to the next segment; using duration ${mp4SampleDuration/90} ms for the last video frame.`);\n            } else {\n              mp4SampleDuration = lastFrameDuration;\n            }\n          } else {\n            mp4SampleDuration = lastFrameDuration;\n          }\n        }\n        mp4SampleDuration /= pes2mp4ScaleFactor;\n        compositionTimeOffset = Math.round((avcSample.pts - avcSample.dts) / pes2mp4ScaleFactor);\n      } else {\n        compositionTimeOffset = Math.max(0,mp4SampleDuration*Math.round((avcSample.pts - avcSample.dts)/(pes2mp4ScaleFactor*mp4SampleDuration)));\n      }\n     outputSamples.push({\n        size: mp4SampleLength,\n         // constant duration\n        duration: mp4SampleDuration,\n        cts: compositionTimeOffset,\n        flags: {\n          isLeading: 0,\n          isDependedOn: 0,\n          hasRedundancy: 0,\n          degradPrio: 0,\n          dependsOn : avcSample.key ? 2 : 1,\n          isNonSync : avcSample.key ? 0 : 1\n        }\n      });\n    }\n    // next AVC sample DTS should be equal to last sample DTS + last sample duration (in PES timescale)\n    this.nextAvcDts = lastDTS + mp4SampleDuration*pes2mp4ScaleFactor;\n    let dropped = track.dropped;\n    track.len = 0;\n    track.nbNalu = 0;\n    track.dropped = 0;\n    if(outputSamples.length && navigator.userAgent.toLowerCase().indexOf('chrome') > -1) {\n      let flags = outputSamples[0].flags;\n    // chrome workaround, mark first sample as being a Random Access Point to avoid sourcebuffer append issue\n    // https://code.google.com/p/chromium/issues/detail?id=229412\n      flags.dependsOn = 2;\n      flags.isNonSync = 0;\n    }\n    track.samples = outputSamples;\n    moof = MP4.moof(track.sequenceNumber++, firstDTS / pes2mp4ScaleFactor, track);\n    track.samples = [];\n\n    let data = {\n      id : this.id,\n      level : this.level,\n      sn : this.sn,\n      data1: moof,\n      data2: mdat,\n      startPTS: firstPTS / pesTimeScale,\n      endPTS: (lastPTS + pes2mp4ScaleFactor * mp4SampleDuration) / pesTimeScale,\n      startDTS: firstPTS / pesTimeScale,\n      endDTS: (lastPTS + pes2mp4ScaleFactor * mp4SampleDuration) / pesTimeScale,\n     // startDTS: firstDTS / pesTimeScale,\n     // endDTS: this.nextAvcDts / pesTimeScale,\n      type: 'video',\n      nb: outputSamples.length,\n      dropped : dropped\n    };\n    this.observer.trigger(Event.FRAG_PARSING_DATA, data);\n    return data;\n  }\n\n  remuxAudio(track, timeOffset, contiguous) {\n    let pesTimeScale = this.PES_TIMESCALE,\n        mp4timeScale = track.timescale,\n        pes2mp4ScaleFactor = pesTimeScale/mp4timeScale,\n        expectedSampleDuration = track.timescale * 1024 / track.audiosamplerate;\n    var view,\n        offset = 8,\n        aacSample, mp4Sample,\n        unit,\n        mdat, moof,\n        firstPTS, firstDTS, lastDTS,\n        pts, dts, ptsnorm, dtsnorm,\n        samples = [],\n        samples0 = [];\n\n    track.samples.sort(function(a, b) {\n      return (a.pts-b.pts);\n    });\n    samples0 = track.samples;\n\n    let nextAacPts = (contiguous ? this.nextAacPts : timeOffset*pesTimeScale);\n\n    // If the audio track is missing samples, the frames seem to get \"left-shifted\" within the\n    // resulting mp4 segment, causing sync issues and leaving gaps at the end of the audio segment.\n    // In an effort to prevent this from happening, we inject frames here where there are gaps.\n    // When possible, we inject a silent frame; when that's not possible, we duplicate the last\n    // frame.\n    let firstPtsNorm = this._PTSNormalize(samples0[0].pts - this._initPTS, nextAacPts),\n        pesFrameDuration = expectedSampleDuration * pes2mp4ScaleFactor;\n    var nextPtsNorm = firstPtsNorm + pesFrameDuration;\n    for (var i = 1; i < samples0.length; ) {\n      // First, let's see how far off this frame is from where we expect it to be\n      var sample = samples0[i],\n          ptsNorm = this._PTSNormalize(sample.pts - this._initPTS, nextAacPts),\n          delta = ptsNorm - nextPtsNorm;\n\n      // If we're overlapping by more than half a duration, drop this sample\n      if (delta < (-0.5 * pesFrameDuration)) {\n        logger.log(`Dropping frame due to ${Math.abs(delta / 90)} ms overlap.`);\n        samples0.splice(i, 1);\n        track.len -= sample.unit.length;\n        // Don't touch nextPtsNorm or i\n      }\n      // Otherwise, if we're more than half a frame away from where we should be, insert missing frames\n      else if (delta > (0.5 * pesFrameDuration)) {\n        var missing = Math.round(delta / pesFrameDuration);\n        logger.log(`Injecting ${missing} frame${missing > 1 ? 's' : ''} of missing audio due to ${Math.round(delta / 90)} ms gap.`);\n        for (var j = 0; j < missing; j++) {\n          var newStamp = samples0[i - 1].pts + pesFrameDuration,\n              fillFrame = AAC.getSilentFrame(track.channelCount);\n          if (!fillFrame) {\n            logger.log('Unable to get silent frame for given audio codec; duplicating last frame instead.');\n            fillFrame = sample.unit.slice(0);\n          }\n          samples0.splice(i, 0, {unit: fillFrame, pts: newStamp, dts: newStamp});\n          track.len += fillFrame.length;\n          i += 1;\n        }\n\n        // Adjust sample to next expected pts\n        nextPtsNorm += (missing + 1) * pesFrameDuration;\n        sample.pts = samples0[i - 1].pts + pesFrameDuration;\n        i += 1;\n      }\n      // Otherwise, we're within half a frame duration, so just adjust pts\n      else {\n        if (Math.abs(delta) > (0.1 * pesFrameDuration)) {\n          logger.log(`Invalid frame delta ${ptsNorm - nextPtsNorm + pesFrameDuration} at PTS ${Math.round(ptsNorm / 90)} (should be ${pesFrameDuration}).`);\n        }\n        nextPtsNorm += pesFrameDuration;\n        sample.pts = samples0[i - 1].pts + pesFrameDuration;\n        i += 1;\n      }\n    }\n\n    while (samples0.length) {\n      aacSample = samples0.shift();\n      unit = aacSample.unit;\n      pts = aacSample.pts - this._initDTS;\n      dts = aacSample.dts - this._initDTS;\n      //logger.log(`Audio/PTS:${Math.round(pts/90)}`);\n      // if not first sample\n      if (lastDTS !== undefined) {\n        ptsnorm = this._PTSNormalize(pts, lastDTS);\n        dtsnorm = this._PTSNormalize(dts, lastDTS);\n        mp4Sample.duration = (dtsnorm - lastDTS) / pes2mp4ScaleFactor;\n      } else {\n        ptsnorm = this._PTSNormalize(pts, nextAacPts);\n        dtsnorm = this._PTSNormalize(dts, nextAacPts);\n        let delta = Math.round(1000 * (ptsnorm - nextAacPts) / pesTimeScale);\n        // if fragment are contiguous, detect hole/overlapping between fragments\n        if (contiguous) {\n          // log delta\n          if (delta) {\n            if (delta > 0) {\n              logger.log(`${delta} ms hole between AAC samples detected,filling it`);\n              // if we have frame overlap, overlapping for more than half a frame duraion\n            } else if (delta < -12) {\n              // drop overlapping audio frames... browser will deal with it\n              logger.log(`${(-delta)} ms overlapping between AAC samples detected, drop frame`);\n              track.len -= unit.byteLength;\n              continue;\n            }\n            // set PTS/DTS to expected PTS/DTS\n            ptsnorm = dtsnorm = nextAacPts;\n          }\n        }\n        // remember first PTS of our aacSamples, ensure value is positive\n        firstPTS = Math.max(0, ptsnorm);\n        firstDTS = Math.max(0, dtsnorm);\n        if(track.len > 0) {\n          /* concatenate the audio data and construct the mdat in place\n            (need 8 more bytes to fill length and mdat type) */\n          mdat = new Uint8Array(track.len + 8);\n          view = new DataView(mdat.buffer);\n          view.setUint32(0, mdat.byteLength);\n          mdat.set(MP4.types.mdat, 4);\n        } else {\n          // no audio samples\n          return;\n        }\n      }\n      mdat.set(unit, offset);\n      offset += unit.byteLength;\n      //console.log('PTS/DTS/initDTS/normPTS/normDTS/relative PTS : ${aacSample.pts}/${aacSample.dts}/${this._initDTS}/${ptsnorm}/${dtsnorm}/${(aacSample.pts/4294967296).toFixed(3)}');\n      mp4Sample = {\n        size: unit.byteLength,\n        cts: 0,\n        duration:0,\n        flags: {\n          isLeading: 0,\n          isDependedOn: 0,\n          hasRedundancy: 0,\n          degradPrio: 0,\n          dependsOn: 1,\n        }\n      };\n      samples.push(mp4Sample);\n      lastDTS = dtsnorm;\n    }\n    var lastSampleDuration = 0;\n    var nbSamples = samples.length;\n    //set last sample duration as being identical to previous sample\n    if (nbSamples >= 2) {\n      lastSampleDuration = samples[nbSamples - 2].duration;\n      mp4Sample.duration = lastSampleDuration;\n    }\n    if (nbSamples) {\n      // next aac sample PTS should be equal to last sample PTS + duration\n      this.nextAacPts = ptsnorm + pes2mp4ScaleFactor * lastSampleDuration;\n      //logger.log('Audio/PTS/PTSend:' + aacSample.pts.toFixed(0) + '/' + this.nextAacDts.toFixed(0));\n      track.len = 0;\n      track.samples = samples;\n      moof = MP4.moof(track.sequenceNumber++, firstDTS / pes2mp4ScaleFactor, track);\n      track.samples = [];\n      let audioData = {\n        id : this.id,\n        level : this.level,\n        sn : this.sn,\n        data1: moof,\n        data2: mdat,\n        startPTS: firstPTS / pesTimeScale,\n        endPTS: this.nextAacPts / pesTimeScale,\n        startDTS: firstDTS / pesTimeScale,\n        endDTS: (dtsnorm + pes2mp4ScaleFactor * lastSampleDuration) / pesTimeScale,\n        type: 'audio',\n        nb: nbSamples\n      };\n      this.observer.trigger(Event.FRAG_PARSING_DATA, audioData);\n      return audioData;\n    }\n    return null;\n  }\n\n  remuxEmptyAudio(track, timeOffset, contiguous, videoData) {\n    let pesTimeScale = this.PES_TIMESCALE,\n        mp4timeScale = track.timescale ? track.timescale : track.audiosamplerate,\n        pes2mp4ScaleFactor = pesTimeScale/mp4timeScale,\n\n        // sync with video's timestamp\n        startDTS = videoData.startDTS * pesTimeScale + this._initDTS,\n        endDTS = videoData.endDTS * pesTimeScale + this._initDTS,\n\n        // one sample's duration value\n        sampleDuration = 1024,\n        frameDuration = pes2mp4ScaleFactor * sampleDuration,\n\n        // samples count of this segment's duration\n        nbSamples = Math.ceil((endDTS - startDTS) / frameDuration),\n\n        // silent frame\n        silentFrame = AAC.getSilentFrame(track.channelCount);\n\n    // Can't remux if we can't generate a silent frame...\n    if (!silentFrame) {\n      logger.trace('Unable to remuxEmptyAudio since we were unable to get a silent frame for given audio codec!');\n      return;\n    }\n\n    let samples = [];\n    for(var i = 0; i < nbSamples; i++) {\n      var stamp = startDTS + i * frameDuration;\n      samples.push({unit: silentFrame.slice(0), pts: stamp, dts: stamp});\n      track.len += silentFrame.length;\n    }\n    track.samples = samples;\n\n    this.remuxAudio(track, timeOffset, contiguous);\n  }\n\n  remuxID3(track,timeOffset) {\n    var length = track.samples.length, sample;\n    // consume samples\n    if(length) {\n      for(var index = 0; index < length; index++) {\n        sample = track.samples[index];\n        // setting id3 pts, dts to relative time\n        // using this._initPTS and this._initDTS to calculate relative time\n        sample.pts = ((sample.pts - this._initPTS) / this.PES_TIMESCALE);\n        sample.dts = ((sample.dts - this._initDTS) / this.PES_TIMESCALE);\n      }\n      this.observer.trigger(Event.FRAG_PARSING_METADATA, {\n        id : this.id,\n        level : this.level,\n        sn : this.sn,\n        samples:track.samples\n      });\n    }\n\n    track.samples = [];\n    timeOffset = timeOffset;\n  }\n\n  remuxText(track,timeOffset) {\n    track.samples.sort(function(a, b) {\n      return (a.pts-b.pts);\n    });\n\n    var length = track.samples.length, sample;\n    // consume samples\n    if(length) {\n      for(var index = 0; index < length; index++) {\n        sample = track.samples[index];\n        // setting text pts, dts to relative time\n        // using this._initPTS and this._initDTS to calculate relative time\n        sample.pts = ((sample.pts - this._initPTS) / this.PES_TIMESCALE);\n      }\n      this.observer.trigger(Event.FRAG_PARSING_USERDATA, {\n        id : this.id,\n        level : this.level,\n        sn : this.sn,\n        samples:track.samples\n      });\n    }\n\n    track.samples = [];\n    timeOffset = timeOffset;\n  }\n\n  _PTSNormalize(value, reference) {\n    var offset;\n    if (reference === undefined) {\n      return value;\n    }\n    if (reference < value) {\n      // - 2^33\n      offset = -8589934592;\n    } else {\n      // + 2^33\n      offset = 8589934592;\n    }\n    /* PTS is 33bit (from 0 to 2^33 -1)\n      if diff between value and reference is bigger than half of the amplitude (2^32) then it means that\n      PTS looping occured. fill the gap */\n    while (Math.abs(value - reference) > 4294967296) {\n        value += offset;\n    }\n    return value;\n  }\n\n}\n\nexport default MP4Remuxer;\n",
    "'use strict';\n\nfunction noop() {}\n\nconst fakeLogger = {\n  trace: noop,\n  debug: noop,\n  log: noop,\n  warn: noop,\n  info: noop,\n  error: noop\n};\n\nlet exportedLogger = fakeLogger;\n\n//let lastCallTime;\n// function formatMsgWithTimeInfo(type, msg) {\n//   const now = Date.now();\n//   const diff = lastCallTime ? '+' + (now - lastCallTime) : '0';\n//   lastCallTime = now;\n//   msg = (new Date(now)).toISOString() + ' | [' +  type + '] > ' + msg + ' ( ' + diff + ' ms )';\n//   return msg;\n// }\n\nfunction formatMsg(type, msg) {\n  msg = '[' +  type + '] > ' + msg;\n  return msg;\n}\n\nfunction consolePrintFn(type) {\n  const func = window.console[type];\n  if (func) {\n    return function(...args) {\n      if(args[0]) {\n        args[0] = formatMsg(type, args[0]);\n      }\n      func.apply(window.console, args);\n    };\n  }\n  return noop;\n}\n\nfunction exportLoggerFunctions(debugConfig, ...functions) {\n  functions.forEach(function(type) {\n    exportedLogger[type] = debugConfig[type] ? debugConfig[type].bind(debugConfig) : consolePrintFn(type);\n  });\n}\n\nexport var enableLogs = function(debugConfig) {\n  if (debugConfig === true || typeof debugConfig === 'object') {\n    exportLoggerFunctions(debugConfig,\n      // Remove out from list here to hard-disable a log-level\n      //'trace',\n      'debug',\n      'log',\n      'info',\n      'warn',\n      'error'\n    );\n    // Some browsers don't allow to use bind on console object anyway\n    // fallback to default if needed\n    try {\n     exportedLogger.log();\n    } catch (e) {\n      exportedLogger = fakeLogger;\n    }\n  }\n  else {\n    exportedLogger = fakeLogger;\n  }\n};\n\nexport var logger = exportedLogger;\n",
    "if (typeof ArrayBuffer !== 'undefined' && !ArrayBuffer.prototype.slice) {\n  ArrayBuffer.prototype.slice = function (start, end) {\n    var that = new Uint8Array(this);\n    if (end === undefined) {\n      end = that.length;\n    }\n    var result = new ArrayBuffer(end - start);\n    var resultArray = new Uint8Array(result);\n    for (var i = 0; i < resultArray.length; i++) {\n      resultArray[i] = that[i + start];\n    }\n    return result;\n  };\n}\n",
    "/**\n * XHR based logger\n*/\n\n \nclass XhrLoader {\n\n  constructor(config) {\n    if (config && config.xhrSetup) {\n      this.xhrSetup = config.xhrSetup;\n    }\n  }\n\n  destroy() {\n    this.abort();\n    this.loader = null;\n  }\n\n  abort() {\n    var loader = this.loader;\n    if (loader && loader.readyState !== 4) {\n      this.stats.aborted = true;\n      loader.abort();\n    }\n\n    window.clearTimeout(this.requestTimeout);\n    this.requestTimeout = null;\n    window.clearTimeout(this.retryTimeout);\n    this.retryTimeout = null;\n  }\n\n  loadHead(context, config, callbacks) {\n    this.context = context;\n    this.config = config;\n    this.callbacks = callbacks;\n    this.stats = {trequest: performance.now(), retry: 0};\n    this.retryDelay = config.retryDelay;\n    var xhr = new XMLHttpRequest;\n    xhr.open('head', context.url);\n    xhr.onload = function () {\n          callbacks.onSuccess(xhr.getResponseHeader('content-length'));\n    };\n    xhr.send();\n  }\n\n  load(context, config, callbacks) {\n    this.context = context;\n    this.config = config;\n    this.callbacks = callbacks;\n    this.stats = {trequest: performance.now(), retry: 0};\n    this.retryDelay = config.retryDelay;\n    this.loadInternal(); \n  }\n \n  loadInternal() {\n    var xhr, context = this.context;\n    if (typeof XDomainRequest !== 'undefined') {\n       xhr = this.loader = new XDomainRequest();\n    } else {\n       xhr = this.loader = new XMLHttpRequest();\n    }\n    xhr.onloadend = this.loadend.bind(this);\n    xhr.onprogress = this.loadprogress.bind(this);\n    xhr.open('GET', context.url, true);\n    if (context.rangeEnd) {\n      xhr.setRequestHeader('Range','bytes=' + context.rangeStart + '-' + (context.rangeEnd-1));\n    }\n    xhr.responseType = context.responseType;\n    let stats = this.stats;\n    stats.tfirst = 0;\n    stats.loaded = 0;\n    if (this.xhrSetup) {\n      this.xhrSetup(xhr, context.url);\n    }     \n    // setup timeout before we perform request\n    this.requestTimeout = window.setTimeout(this.loadtimeout.bind(this), this.config.timeout);\n    xhr.send();\n  }\n\n  loadend(event) {\n    var xhr = event.currentTarget,\n        status = xhr.status,\n        stats = this.stats,\n        context = this.context,\n        config = this.config;\n    // don't proceed if xhr has been aborted\n    if (stats.aborted) {\n      return;\n    }\n    // in any case clear the current xhrs timeout\n    window.clearTimeout(this.requestTimeout);\n\n    // http status between 200 to 299 are all successful\n    if (status >= 200 && status < 300)  {\n      stats.tload = Math.max(stats.tfirst,performance.now());\n      let data,len;\n      if (context.responseType === 'arraybuffer') {\n        data = xhr.response;\n        len = data.byteLength;\n      } else {\n        data = xhr.responseText;\n        len = data.length;\n      }\n      stats.loaded = stats.total = len;\n      let response = { url : xhr.responseURL, data : data };\n      this.callbacks.onSuccess(response, stats, context);\n    } else {\n      // if max nb of retries reached or if http status between 400 and 499 (such error cannot be recovered, retrying is useless), return error\n      if (stats.retry >= config.maxRetry || (status >= 400 && status < 499)) {\n      //  logger.error(`${status} while loading ${context.url}` );\n        this.callbacks.onError({ code : status, text : xhr.statusText}, context);\n      } else {\n      // retry\n      //  logger.warn(`${status} while loading ${context.url}, retrying in ${this.retryDelay}...`);\n        // aborts and resets internal state\n        this.destroy();\n        // schedule retry\n        this.retryTimeout = window.setTimeout(this.loadInternal.bind(this), this.retryDelay);\n        // set exponential backoff\n        this.retryDelay = Math.min(2 * this.retryDelay, config.maxRetryDelay);\n        stats.retry++;\n      }\n    }\n  }\n\n  loadtimeout() {\n  //  logger.warn(`timeout while loading ${this.context.url}` );\n    this.callbacks.onTimeout(this.stats, this.context);\n  }\n\n  loadprogress(event) {\n    var stats = this.stats;\n    if (stats.tfirst === 0) {\n      stats.tfirst = Math.max(performance.now(), stats.trequest);\n    }\n    stats.loaded = event.loaded;\n    if (event.lengthComputable) {\n      stats.total = event.total;\n    }\n    let onProgress = this.callbacks.onProgress;\n    if (onProgress) {\n      // last args is to provide on progress data\n      onProgress(stats, this.context, null);\n    }\n  }\n}\n\nexport default XhrLoader;\n",
    "/**\n * WFS interface, Jeff Yang 2016.10\n */\n'use strict';\n\nimport Event from './events';\nimport FlowController from  './controller/flow-controller'; \nimport BufferController from  './controller/buffer-controller';\nimport EventEmitter from 'events';\nimport XhrLoader from './utils/xhr-loader';\nimport FileLoader from './loader/file-loader';\nimport WebsocketLoader from './loader/websocket-loader';\n\n\nclass Wfs {\n\n  static get version() {\n    // replaced with browserify-versionify transform\n    return ''+'v.0.0.0.1';\n  }\n\n  static isSupported() {\n    return (window.MediaSource &&\n            typeof window.MediaSource.isTypeSupported === 'function' &&\n            window.MediaSource.isTypeSupported('video/mp4; codecs=\"avc1.42c01f,mp4a.40.2\"'));\n  }\n  \n  static get Events() {\n    return Event;\n  }\n \n  static get DefaultConfig() {\n    if(!Wfs.defaultConfig) {\n       Wfs.defaultConfig = {\n        autoStartLoad: true,\n        startPosition: -1,\n        debug: false, \n        fLoader: undefined,\n        loader: XhrLoader,\n        //loader: FetchLoader,\n        fmp4FileUrl: 'xxxx.mp4',\n        fragLoadingTimeOut: 20000,\n        fragLoadingMaxRetry: 6,\n        fragLoadingRetryDelay: 1000,\n        fragLoadingMaxRetryTimeout: 64000,\n        fragLoadingLoopThreshold: 3,\n        forceKeyFrameOnDiscontinuity: true,\n        appendErrorMaxRetry: 3\n      };\n    }\n    return Wfs.defaultConfig;\n  }\n\n  static set DefaultConfig(defaultConfig) {\n    Wfs.defaultConfig = defaultConfig;\n  }\n\n  constructor(config = {}) {\n\n    var defaultConfig = Wfs.DefaultConfig;\n    for (var prop in defaultConfig) {\n        if (prop in config) { continue; }\n        config[prop] = defaultConfig[prop];\n    }\n    this.config = config;  \n    // observer setup\n    var observer = this.observer = new EventEmitter();\n    observer.trigger = function trigger (event, ...data) {\n      observer.emit(event, event, ...data);\n    };\n\n    observer.off = function off (event, ...data) {\n      observer.removeListener(event, ...data);\n    };\n    this.on = observer.on.bind(observer);\n    this.off = observer.off.bind(observer);\n    this.trigger = observer.trigger.bind(observer);\n\n    this.flowController = new FlowController(this);\n    this.bufferController = new BufferController(this);\n  //  this.fileLoader = new FileLoader(this);\n    this.websocketLoader = new WebsocketLoader(this);\n    this.mediaType = undefined;     \n  }\n\n  destroy() {\n    this.flowController.destroy();\n    this.bufferController.destroy();\n //   this.fileLoader.destroy();\n    this.websocketLoader.destroy();\n  }\n\n  attachMedia(media, channelName='chX',mediaType='H264Raw', websocketName='play2') { // 'H264Raw' 'FMp4'    \n    this.mediaType = mediaType; \n    this.media = media;\n    this.trigger(Event.MEDIA_ATTACHING, {media:media, channelName:channelName, mediaType:mediaType, websocketName:websocketName });\n  }\n  \n  attachWebsocket(websocket,channelName) { \n    this.trigger(Event.WEBSOCKET_ATTACHING, {websocket: websocket, mediaType:this.mediaType, channelName:channelName });\n  }\n\n}\n\nexport default Wfs;\n"
  ]
}